[
  {
    "objectID": "posts/time_series_1_pro/Chapter_1_sol.html",
    "href": "posts/time_series_1_pro/Chapter_1_sol.html",
    "title": "时间序列分析：第一章习题答案",
    "section": "",
    "text": "主要参考书籍为Shumway和Stoffer(2017)的Time Series Analysis and Its Applications: With R Examples。\n该书第五版正在制作，配套astsa包中的部分数据集会逐渐更新，所以后期也许会换成第五版内容。\n该内容为第一章的习题答案，基于个人习惯，使用的大多数是tidyverse系列代码，会和之前学习笔记中的代码习惯有所不同。\nlibrary(tidyverse)\nlibrary(astsa)\nlibrary(cowplot)"
  },
  {
    "objectID": "posts/time_series_1_pro/Chapter_1_sol.html#section",
    "href": "posts/time_series_1_pro/Chapter_1_sol.html#section",
    "title": "时间序列分析：第一章习题答案",
    "section": "1.1",
    "text": "1.1\n\ndata &lt;- data.frame(\n    time = 1:length(EQ5),\n    Earthquake = EQ5,\n    Explosion = EXP6\n) %&gt;%\n    pivot_longer(\n        cols = c(\"Earthquake\", \"Explosion\"),\n        names_to = \"type\",\n        values_to = \"value\"\n    )\n\nggplot(data, aes(x = time, y = value, color = type)) +\n    geom_line() +\n    labs(y = \"Amplitude\", x = \"Time\", title = \"Earthquake vs Explosion Signals\") +\n    scale_color_manual(values = c(\"black\", \"red\")) +\n    theme_minimal() +\n    theme(legend.position = \"top\") +\n    guides(color = guide_legend(title = NULL, override.aes = list(linetype = 1)))\n\n\n\n\n\n\n\n\n爆炸信号消失得更快，早期振幅更大。"
  },
  {
    "objectID": "posts/time_series_1_pro/Chapter_1_sol.html#section-1",
    "href": "posts/time_series_1_pro/Chapter_1_sol.html#section-1",
    "title": "时间序列分析：第一章习题答案",
    "section": "1.2",
    "text": "1.2\n(a)和(c)\n\nset.seed(44)\ns_a &lt;- c(rep(0, 100), 10 * exp(-(101:200 - 100) / 20) * cos(2 * pi * 101:200 / 4))\nx_a = s_a + rnorm(200)\ndecay_line_a = c(rep(0, 100), 10 * exp(-(1:100) / 20))\ndata_a &lt;- as_tibble(x_a) %&gt;%\n    mutate(time = 1:200, decay_line = decay_line_a)\nggplot(data_a, aes(x = time)) +\n    geom_line(aes(y = value), color = \"black\") +\n    geom_line(aes(y = decay_line), color = \"red\") +\n    theme_minimal()\n\n\n\n\n\n\n\n\n(b)和(c)\n\nset.seed(44)\ns_b = c(rep(0, 100), 10 * exp(-(101:200 - 100) / 200) * cos(2 * pi * 101:200 / 4))\nx_b = s_b + rnorm(200)\ndecay_line_b = c(rep(0, 100), 10 * exp(-(1:100) / 200))\ndata_b &lt;- as_tibble(x_b) %&gt;%\n    mutate(time = 1:200, decay_line = decay_line_b)\nggplot(data_b, aes(x = time)) +\n    geom_line(aes(y = value), color = \"black\") +\n    geom_line(aes(y = decay_line), color = \"red\") +\n    theme_minimal()"
  },
  {
    "objectID": "posts/time_series_1_pro/Chapter_1_sol.html#section-2",
    "href": "posts/time_series_1_pro/Chapter_1_sol.html#section-2",
    "title": "时间序列分析：第一章习题答案",
    "section": "1.3",
    "text": "1.3\n(a)-(c)\n\nset.seed(44)\nw = rnorm(150, 0, 1)\nx = stats::filter(w, filter = c(0, -0.9), method = \"recursive\")[-(1:50)]\nx2 = 2 * cos(2 * pi * (1:100) / 4)\nx3 = x2 + rnorm(100, 0, 1)\n\nv = stats::filter(x, rep(1, 4) / 4, sides = 1)\nv2 = stats::filter(x2, rep(1, 4) / 4, sides = 1)\nv3 = stats::filter(x3, rep(1, 4) / 4, sides = 1)\n\ndata &lt;- tibble(\n    time = rep(1:100, 3),\n    x_value = c(x, x2, x3),\n    v_value = c(v, v2, v3),\n    type = rep(c(\n        \"autoregression\", \"sinusoid\", \"sinusoid + noise\"\n    ), each = 100)\n) %&gt;%\n    pivot_longer(\n        cols = c(\"x_value\", \"v_value\"),\n        names_to = \"series\",\n        values_to = \"value\"\n    )\n\nggplot(data, aes(\n    x = time,\n    y = value,\n    color = series,\n    linetype = series\n)) +\n    geom_line() +\n    facet_wrap(~ type, ncol = 1) +\n    labs(y = \"Value\", x = \"Time\", title = \"Time Series and Moving Averages\") +\n    scale_color_manual(\n        values = c(\"x_value\" = \"blue\", \"v_value\" = \"red\"),\n        breaks = c(\"x_value\", \"v_value\")\n    ) +\n    scale_linetype_manual(\n        values = c(\"x_value\" = \"solid\", \"v_value\" = \"dashed\"),\n        breaks = c(\"x_value\", \"v_value\")\n    ) +\n    theme_minimal()\n\n\n\n\n\n\n\n\n\n\n\n移动平均后都变得更为平缓。"
  },
  {
    "objectID": "posts/time_series_1_pro/Chapter_1_sol.html#section-3",
    "href": "posts/time_series_1_pro/Chapter_1_sol.html#section-3",
    "title": "时间序列分析：第一章习题答案",
    "section": "1.4",
    "text": "1.4\n\\[\n\\begin{aligned}\n\\gamma(s,t)&=\\operatorname{cov}(x_t,x_t)=\\operatorname{E}[(x_s-\\mu_s)(x_t-\\mu_t)]\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_t\\operatorname{E}(x_s)-\\mu_s\\operatorname{E}(x_t)+\\mu_s\\mu_t\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_t\\mu_s-\\mu_s\\mu_t+\\mu_s\\mu_t\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_s\\mu_t\n\\end{aligned}\n\\]"
  },
  {
    "objectID": "posts/time_series_1_pro/Chapter_1_sol.html#section-4",
    "href": "posts/time_series_1_pro/Chapter_1_sol.html#section-4",
    "title": "时间序列分析：第一章习题答案",
    "section": "1.5",
    "text": "1.5\n\n\n\n\\[\n\\mu_{x}=\\operatorname{E}(s_t+w_t)=s_t\n\\]\n\n# a\nset.seed(44)\ns_a &lt;- c(rep(0, 100), 10 * exp(-(101:200 - 100) / 20) * cos(2 * pi * 101:200 / 4))\ndata_a &lt;- tibble(time = 1:200, s_a = s_a)\np_15a &lt;- ggplot(data_a, aes(x = time, y = s_a)) +\n    geom_line() +\n    theme_minimal()\n\n# b\nset.seed(44)\ns_b = c(rep(0, 100), 10 * exp(-(101:200 - 100) / 200) * cos(2 * pi * 101:200 / 4))\ndata_a &lt;- tibble(time = 1:200, s_b = s_b)\np_15b &lt;- ggplot(data_a, aes(x = time, y = s_b)) +\n    geom_line() +\n    theme_minimal()\n\nplot_grid(p_15a, p_15b, ncol = 1)\n\n\n\n\n\n\n\n\n\n\n\n\\[\n\\begin{aligned}\n\\gamma_x(s,t)&=\\operatorname{cov}(x_s,x_t)=\\operatorname{E}[(x_s-\\mu_s)(x_t-\\mu_t)]\\\\\n&=\\operatorname{E}[(x_s-s_s)(x_t-s_t)]\\\\\n&=\\operatorname{E}(w_sw_t)\n\\end{aligned}\n\\]\n所以有：\n\\[\n\\gamma_x(s,t)=\n\\begin{cases}\n\\sigma^2_w=1&s=t\\\\\n0&s\\neq t\n\\end{cases}\n\\]"
  },
  {
    "objectID": "posts/time_series_1_pro/Chapter_1_sol.html#section-5",
    "href": "posts/time_series_1_pro/Chapter_1_sol.html#section-5",
    "title": "时间序列分析：第一章习题答案",
    "section": "1.6",
    "text": "1.6\n\n\n\n平均函数：\n\\[\n\\operatorname{E}(x_t)=\\operatorname{E}(\\beta_1+\\beta_2t)=\\beta_1+\\beta_2t\n\\]\n不是常数，故不是平稳的。\n\n\n\n\\[\ny_t=x_t-x_{t-1}=\\beta_2+w_t-w_{t-1}\n\\]\n平均函数：\n\\[\n\\operatorname{E}(y_t)=\\operatorname{E}(\\beta_2+w_t-w_{t-1})=\\beta_2\n\\]\n自协方差函数：\n\\[\n\\begin{aligned}\n\\gamma_y(h)&=\\operatorname{cov}(y_{t+h},y_t)=\\operatorname{cov}(\\beta_2+w_{t+h}-w_{t+h-1},\\beta_2+w_t-w_{t-1})\\\\\n&=\\operatorname{cov}(w_{t+h},w_t)-\\operatorname{cov}(w_{t+h},w_{t-1})-\\operatorname{cov}(w_{t+h-1},w_t)+\\operatorname{cov}(w_{t+h-1},w_{t-1})\n\\end{aligned}\n\\]\n显然与\\(t\\)无关，结果为：\n\\[\n\\gamma_y(h)=\\begin{cases}\n2&h=0\\\\\n-1&h=\\pm1\\\\\n0&|h|\\ge2\n\\end{cases}\n\\]\n所以\\(y_t\\)是平稳的。\n\n\n\n平均函数：\n\\[\n\\begin{aligned}\n\\operatorname{E}(v_t)&=\\frac{1}{2q+1}\\sum_{j=-q}^{q}(\\beta_1+\\beta_2t-\\beta_2j)\\\\\n&=\\frac{1}{2q+1}[(2q+1)(\\beta_1+\\beta_2t)-\\beta_2\\sum_{j=-q}^{q}j]\\\\\n&=\\beta_1+\\beta_2t\n\\end{aligned}\n\\]\n自协方差函数：\n先对\\(v_t\\)进行分解。\n\\[\n\\begin{aligned}\nv_t&=\\frac{1}{2q+1}\\sum_{j=-q}^{q}(\\beta_1+\\beta_2t-\\beta_2j+w_{t-j})\\\\\n&=\\frac{1}{2q+1}[(2q+1)\\beta_1+(2q+1)\\beta_2t+\\sum_{j=-q}^{q}w_{t-j}]\\\\\n&=\\beta_1+\\beta_2t+\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t-j}\n\\end{aligned}\n\\]\n\\[\n\\begin{aligned}\n\\gamma_v(h)&=\\operatorname{cov}(v_{t+h},v_t)\\\\\n&=\\operatorname{cov}(\\beta_1+\\beta_2(t+h)+\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t+h-j},\\beta_1+\\beta_2t+\\frac{1}{2q+1}\\sum_{k=-q}^{q}w_{t-k})\\\\\n&=\\operatorname{cov}(\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t+h-j},\\frac{1}{2q+1}\\sum_{k=-q}^{q}w_{t-k})\\\\\n&=\\frac{1}{(2q+1)^2}\\sum_{j=-q}^{q}\\sum_{k=-q}^{q}\\operatorname{cov}(w_{t+h-j},w_{t-k})\n\\end{aligned}\n\\]\n需要在\\(\\sum_{j=-q}^{q}\\)和\\(\\sum_{k=-q}^{q}\\)中取更小的那个，所以：\n\\[\n\\gamma_v(h)=\\begin{cases}\n\\frac{1}{(2q+1)^2}(2q+1-|h|)\\sigma_w^2&h=j-k\\\\\n0&h\\neq j-k\n\\end{cases}\n\\]\n因为\\(j\\)和\\(k\\)的取值范围都是\\([-q,q]\\)，所以\\(|h|\\le 2q\\)。"
  },
  {
    "objectID": "posts/notes/index.html",
    "href": "posts/notes/index.html",
    "title": "心理语言学",
    "section": "",
    "text": "脑区和功能\n\n\n\n\n\n\n\n\n脑区\n言语功能\n图片\n\n\n\n\n布洛卡区(Broca’s Area)\n\n\n\n\n威尔尼克区(Wernicke’s Area)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "周博霖",
    "section": "",
    "text": "时间序列分析：第一章习题答案\n\n\n\n\n\n\n学习笔记\n\n\n统计方法\n\n\n时间序列分析\n\n\n\n\n\n\n\n\n\nSep 7, 2024\n\n\n周博霖\n\n\n\n\n\n\n\n\n\n\n\n\n时间序列分析：第一章\n\n\n\n\n\n\n学习笔记\n\n\n统计方法\n\n\n时间序列分析\n\n\n\n\n\n\n\n\n\nSep 6, 2024\n\n\n周博霖\n\n\n\n\n\n\n\n\n\n\n\n\n心理语言学\n\n\n\n\n\n\n学习笔记\n\n\n心理语言学\n\n\n\n\n\n\n\n\n\nAug 9, 2024\n\n\n周博霖\n\n\n\n\n\n\n无匹配项"
  },
  {
    "objectID": "posts/time_series/index.html",
    "href": "posts/time_series/index.html",
    "title": "时间序列分析：第一章",
    "section": "",
    "text": "主要参考书籍为Shumway和Stoffer(2017)的Time Series Analysis and Its Applications: With R Examples。\n该书第五版正在制作，配套astsa包中的部分数据集会逐渐更新，所以后期也许会换成第五版内容。\n该内容为学习笔记，会很碎片化，同时参考了作者在github上给出的代码。\n时间序列分析适用情境：\n两种不同但不一定互斥的时间序列分析方法："
  },
  {
    "objectID": "posts/time_series/index.html#强生公司季度每股收益",
    "href": "posts/time_series/index.html#强生公司季度每股收益",
    "title": "时间序列分析：第一章",
    "section": "1.1 强生公司季度每股收益",
    "text": "1.1 强生公司季度每股收益\njj：强生公司的季度每股收益，从1960年第一季度到1980年最后一季度的84个季度(共21年)。\n\nlibrary(astsa)\njj\n\n          Qtr1      Qtr2      Qtr3      Qtr4\n1960  0.710000  0.630000  0.850000  0.440000\n1961  0.610000  0.690000  0.920000  0.550000\n1962  0.720000  0.770000  0.920000  0.600000\n1963  0.830000  0.800000  1.000000  0.770000\n1964  0.920000  1.000000  1.240000  1.000000\n1965  1.160000  1.300000  1.450000  1.250000\n1966  1.260000  1.380000  1.860000  1.560000\n1967  1.530000  1.590000  1.830000  1.860000\n1968  1.530000  2.070000  2.340000  2.250000\n1969  2.160000  2.430000  2.700000  2.250000\n1970  2.790000  3.420000  3.690000  3.600000\n1971  3.600000  4.320000  4.320000  4.050000\n1972  4.860000  5.040000  5.040000  4.410000\n1973  5.580000  5.850000  6.570000  5.310000\n1974  6.030000  6.390000  6.930000  5.850000\n1975  6.930000  7.740000  7.830000  6.120000\n1976  7.740000  8.910000  8.280000  6.840000\n1977  9.540000 10.260000  9.540000  8.729999\n1978 11.880000 12.060000 12.150000  8.910000\n1979 14.040000 12.960000 14.850000  9.990000\n1980 16.200000 14.670000 16.020000 11.610000\n\n\n\ntsplot(jj, col = 4, type = \"o\", xlab = \"时间\", ylab = \"季度每股收益\")\n\n\n\n\n\n\n\n图 1: 强生公司季度每股收益"
  },
  {
    "objectID": "posts/time_series/index.html#全球变暖",
    "href": "posts/time_series/index.html#全球变暖",
    "title": "时间序列分析：第一章",
    "section": "1.2 全球变暖",
    "text": "1.2 全球变暖\n这里我使用了最新数据，老数据globtemp计划被删除。\ngtemp_land：1850年到2023年，每年地球陆地年平均温度偏差(以摄氏度为单位，相对于1991-2020年的平均值)。\n\ngtemp_land\n\nTime Series:\nStart = 1850 \nEnd = 2023 \nFrequency = 1 \n  [1] -0.50 -0.60 -0.50 -0.50 -0.20 -0.50 -0.80 -0.40 -0.40 -0.10 -0.70 -0.20\n [13] -0.50 -0.20 -0.30 -0.60 -0.40 -0.60 -0.30 -0.50 -0.20 -0.10 -0.40 -0.30\n [25] -0.40 -0.50 -0.20 -0.10  0.26 -0.20 -0.50 -0.40 -0.20 -0.40 -0.70 -0.40\n [37] -0.50 -0.30 -0.70  0.00 -0.20 -0.30 -0.50 -0.40  0.10 -0.50 -0.50 -0.70\n [49] -1.10 -0.50  0.00  0.21 -0.40  0.05 -0.60 -0.70 -0.30 -0.30 -0.80 -0.70\n [61] -0.50 -0.80 -0.70 -0.40 -0.10 -0.20 -0.50 -1.00 -0.30 -0.50  0.05 -0.10\n [73]  0.00 -0.30  0.01 -0.20  0.53 -0.60 -0.20 -0.30  0.21 -0.10 -0.10 -0.30\n [85] -0.30  0.13 -0.30 -0.40  0.38 -0.20  0.06 -0.10 -0.10  0.00  0.36  0.00\n [97]  0.00  0.32 -0.30  0.24  0.00 -0.20 -0.30  0.33 -0.30 -0.60 -0.20 -0.30\n[109]  0.03  0.49 -0.90  0.08  0.36 -0.40 -0.30 -0.10 -0.10  0.19  0.80 -0.20\n[121]  0.00  0.00  0.13  0.61  0.18  0.32 -0.20  0.29  0.37  0.10  0.19  0.85\n[133]  0.00  0.64  0.36  0.42  0.67 -0.20  0.51  0.66  1.61  0.45  0.78  0.64\n[145]  0.41  0.75  0.44  0.81  0.94  0.36  1.14  0.85  1.58  0.84  1.02  1.36\n[157]  1.20  1.27  1.65  0.83  1.54  1.27  0.93  1.10  1.52  1.76  2.50  2.15\n[169]  1.63  2.14  1.95  1.58  2.13  2.26\n\n\n\ntsplot(gtemp_land, col = 4, type = \"o\", xlab = \"时间\", ylab = \"全球温度偏差/℃\")\n\n\n\n\n\n\n\n图 2: 全球陆地年平均温度偏差(1850-2023)"
  },
  {
    "objectID": "posts/time_series/index.html#sec-speech",
    "href": "posts/time_series/index.html#sec-speech",
    "title": "时间序列分析：第一章",
    "section": "1.3 语音数据",
    "text": "1.3 语音数据\nspeech：为“aaa…hhh”这一短语录制的0.1秒(1000采样点)语音样本。\n\nattributes(speech)\n\n$tsp\n[1]    1 1020    1\n\n$class\n[1] \"ts\"\n\n\n\ntsplot(speech)\n\n\n\n\n\n\n\n图 3: 10000点每秒速度采样的音节aaa···hhh的语音记录，n = 1020"
  },
  {
    "objectID": "posts/time_series/index.html#道琼斯工业平均指数",
    "href": "posts/time_series/index.html#道琼斯工业平均指数",
    "title": "时间序列分析：第一章",
    "section": "1.4 道琼斯工业平均指数",
    "text": "1.4 道琼斯工业平均指数\ndjia：从2006年4月20日到2016年4月20日，道琼斯工业平均指数的每日数值\ndjia数据目前只使用其中的收盘价(Close，不确定是昨收还是今收，不过这也不重要)。\n假设\\(x_t\\)是实际值，则\\(r_t=\\frac{x_t-x_{t-1}}{x_{t-1}}\\)是收益率，那么\\(1+r_t=\\frac{x_t}{x_{t-1}}\\)，则有\\(log(1+r_t)=log(\\frac{x_t}{x_{t-1}})=log(x_t)-log(x_{t-1})\\approx r_t\\)(\\(r_t\\)很小，泰勒级数展开后成立)。\ndjiar为2006年4月21日到2016年4月20日的日收益率。\n\nlibrary(xts)\ndjiar = diff(log(djia$Close))[-1]\n\n\nplot(djiar, col = 4, main = \"DJIA Returns\") \n\n\n\n\n\n\n\n图 4: DJIA日收益率"
  },
  {
    "objectID": "posts/time_series/index.html#sec-soi",
    "href": "posts/time_series/index.html#sec-soi",
    "title": "时间序列分析：第一章",
    "section": "1.5 厄尔尼诺和鱼群",
    "text": "1.5 厄尔尼诺和鱼群\nsoi：1950-1987年间453个月的南方涛动指数(SOI)\nrec：1950-1987年间453个月的新鱼数量指数(Recruitment)\n\npar(mfrow = c(2, 1)) \ntsplot(soi, col = 4, xlab = \"\", ylab = \"\", main = \"Southern Oscillation Index\")\ntsplot(rec, col = 4, xlab = \"\", ylab = \"\", main = \"Recruitment\") \n\n\n\n\n\n\n\n图 5: 每月SOI和新鱼数量指数"
  },
  {
    "objectID": "posts/time_series/index.html#fmri成像",
    "href": "posts/time_series/index.html#fmri成像",
    "title": "时间序列分析：第一章",
    "section": "1.6 fMRI成像",
    "text": "1.6 fMRI成像\nfmri1：由8个位置的平均fMRI 血氧水平依赖(BOLD)信号组成的数据集。刺激持续32秒，然后停止32秒。信号周期为64秒，采样率为每2秒1次，采样时间为256秒(\\(n=128\\))。\n\npar(mfrow = c(2, 1))  \ntsplot(fmri1[, 2:5], col = 1:4, ylab = \"BOLD\", main = \"大脑皮层\", spaghetti = TRUE)\ntsplot(fmri1[, 6:9], col = 1:4, ylab = \"BOLD\", main = \"丘脑和小脑\", spaghetti = TRUE)\n\n\n\n\n\n\n\n图 6: 大脑皮层、丘脑、小脑各部位的fMRI数据\n\n\n\n\n\n\ntsplot(fmri1[, 2:9], col = 1:8, lwd = 2, ncol = 2, ylim = c(-.6,.6))\n\n\n\n\n\n\n\n图 7: 分别展示\n\n\n\n\n\n\nx = ts(fmri1[, 4:9], start = 0, freq = 32)         \nnames = c(\"大脑皮层\", \"丘脑\", \"小脑\")\nu = ts(rep(c(rep(.6, 16), rep(-.6, 16)), 4), start = 0, freq = 32)\npar(mfrow = c(3, 1))\nfor (i in 1:3){ \n  j = 2*i - 1\n  tsplot(x[, j:(j+1)], ylab = \"BOLD\", xlab = \"\", main = names[i], col = 5:6, ylim = c(-.6, .6), \n         lwd = 2, xaxt = \"n\", spaghetti = TRUE)\n  axis(seq(0, 256, 64), side = 1, at = 0:4)\n  lines(u, type = \"s\", col = gray(.3)) \n}\nmtext(\"seconds\", side = 1, line = 1.75, cex = .9)\n\n\n\n\n\n\n\n图 8: 包含刺激信息"
  },
  {
    "objectID": "posts/time_series/index.html#地震和爆炸",
    "href": "posts/time_series/index.html#地震和爆炸",
    "title": "时间序列分析：第一章",
    "section": "1.7 地震和爆炸",
    "text": "1.7 地震和爆炸\nEQ5：某地区地震的纵波和横波(两阶段) EXP6：某地区爆炸的纵波和横波(两阶段)\n\npar(mfrow = 2:1)\ntsplot(EQ5,  col = 4, main = \"地震\")\ntsplot(EXP6, col = 4, main = \"爆炸\")\n\n\n\n\n\n\n\n图 9: 地震和爆炸两阶段，1秒40个采样点"
  },
  {
    "objectID": "posts/time_series/index.html#sec-whitenoise",
    "href": "posts/time_series/index.html#sec-whitenoise",
    "title": "时间序列分析：第一章",
    "section": "2.1 白噪声(White Noise)",
    "text": "2.1 白噪声(White Noise)\n白噪声：符合\\(w_t\\sim wn(0,\\sigma_w^2)\\)的不相关随机变量\n独立同分布(independent and identically distributed，iid)的噪声：\\(w_t\\sim iid(0,\\sigma_w^2)\\)\n高斯白噪声(Gaussian white noise)：\\(w_t\\sim iidN(0,\\sigma_w^2)\\)\n\nset.seed(1)\nw = rnorm(500, 0, 1)                                   # 500 N(0,1) variates\nv = stats::filter(w, sides = 2, filter = rep(1/3, 3))  # moving average\npar(mfrow = c(2, 1))\ntsplot(w, col = 4, main = \"white noise\")\ntsplot(v, col = 4, ylim = c(-3, 3), main = \"moving average\")\n\n\n\n\n\n\n\n图 10: 高斯白噪声序列(上)和高斯白噪声序列的三点移动平均值(下)"
  },
  {
    "objectID": "posts/time_series/index.html#sec-moveave",
    "href": "posts/time_series/index.html#sec-moveave",
    "title": "时间序列分析：第一章",
    "section": "2.2 移动平均值(Moving Averages)和过滤(Filtering)",
    "text": "2.2 移动平均值(Moving Averages)和过滤(Filtering)\n用移动平均值\\(v_t\\)替换，从而对\\(w_t\\)进行平滑处理。图 10下方图片就是三点移动平均值，其中\\(v_t=\\frac{1}{3}(w_{t-1}+w_t+w_{t+1})\\)。从实际效果来讲，实现了较慢的振荡被突出，较快的振荡被掩盖。这种序列一般称为滤波序列(filtered series)。\nfilter()函数通俗来讲是用来消除噪声的(滤波)，生成图 10的代码中，参数filter = rep(1/3, 3)其实就是filter = c(1/3, 1/3, 1/3)，分别表示\\(w_{t+1}\\)、\\(w_t\\)和\\(w_{t-1}\\)的系数。\n\nfilter(x,                # ts数据\n       filter,           # 一个逆时间顺序的滤波器系数向量\n       method = c(\"convolution\", \"recursive\"), # 卷积和递归，卷积是移动平均，递归是自回归，默认卷积\n       sides = 2,        # 只用于卷积，1表示单边滤波(只考虑前面的值)，2表示双边滤波(两边都考虑)\n       circular = F,     # 只用于卷积，是否末尾和开头相连\n       init)             # 只用于递归，初始值，默认0"
  },
  {
    "objectID": "posts/time_series/index.html#sec-autoregressions",
    "href": "posts/time_series/index.html#sec-autoregressions",
    "title": "时间序列分析：第一章",
    "section": "2.3 自回归(Autoregressions)",
    "text": "2.3 自回归(Autoregressions)\n可以换种方式替换\\(w_t\\)，即\\(x_t=x_{t-1}-0.9x_{t-2}+w_t\\)。\n\nset.seed(1)\nw = rnorm(550,0,1)  # 50 extra to avoid startup problems\nx = stats::filter(w, filter = c(1, -.9), method = \"recursive\")[-(1:50)]\ntsplot(x, col = 4, main = \"自回归\")\n\n\n\n\n\n\n\n图 11: 自回归序列\n\n\n\n\n\n生成图 11的代码中，init参数默认为0，即\\(x_1=w_1\\)、\\(x_2=x_1+w_2=w_1+w_2\\)，之后\\(x_3=x_2-0.9x_1+w_3\\)。\\(x_1\\)和\\(x_2\\)显然是不符合要求的，常用方法是去除这一部分，生成图 11的代码中多生成了50个数据，之后去除了。"
  },
  {
    "objectID": "posts/time_series/index.html#带漂移项drift的随机游走random-walk",
    "href": "posts/time_series/index.html#带漂移项drift的随机游走random-walk",
    "title": "时间序列分析：第一章",
    "section": "2.4 带漂移项(Drift)的随机游走(Random Walk)",
    "text": "2.4 带漂移项(Drift)的随机游走(Random Walk)\n带漂移项的随机游走模型适合处理图 2所展示的全球变暖相关数据。该模型中\n\\[\nx_t=\\delta+x_{t-1}+w_t\n\\tag{1}\\]\n其中\\(t=1,\\ 2,\\ \\cdots\\)，\\(x_0=0\\)，\\(w_t\\)为白噪声，常数\\(\\delta\\)为漂移项。当\\(\\delta=0\\)时，式 1为随机游走。\n式 1还可以转化为\\(x_t=\\delta t+\\sum_{j=1}^{t}w_j\\)，可见当\\(\\delta=0\\)时，\\(x_t\\)就是白噪声累加和。\n\nset.seed(154)\nw = rnorm(200)\nx = cumsum(w)\nwd = w + .2\nxd = cumsum(wd)\ntsplot(xd, ylim = c(-5, 55), main = \"random walk\", ylab = '')\nlines(x, col = 4) \nclip(0, 200, 0, 50)\nabline(h = 0, col = 4, lty = 2)\nabline(a = 0, b = .2, lty = 2)\n\n\n\n\n\n\n\n图 12: 随机游走图\n\n\n\n\n\n图 12中\\(\\sigma_w=1\\)，黑色实线的漂移项\\(\\delta=0.2\\)，黑色虚线是斜率为0.2的直线，蓝色实线为随机游走(无漂移项，即\\(\\delta=0\\))，蓝色虚线表示\\(y=0\\)的直线。"
  },
  {
    "objectID": "posts/time_series/index.html#噪声信号signal-in-noise",
    "href": "posts/time_series/index.html#噪声信号signal-in-noise",
    "title": "时间序列分析：第一章",
    "section": "2.5 噪声信号(Signal in Noise)",
    "text": "2.5 噪声信号(Signal in Noise)\n很多时间序列模型都是假设由固定周期性变化的信号和随机噪声叠加构成的，图 6所表示的fMRI序列就有很明显的周期性。\n现在令：\n\\[\nx_t=2\\cos(2\\pi\\frac{t+15}{50})+w_t\n\\tag{2}\\]\n其中\\(t=1,\\ 2,\\ \\cdots,\\ 500\\)，第一项\\(2\\cos(2\\pi\\frac{t+15}{50})\\)就是信号。\n正弦波形还可以写成：\n\\[\nA\\cos(2\\pi\\omega t+\\phi)\n\\]\n其中\\(A\\)是振幅，\\(\\omega\\)是振荡频率，\\(\\phi\\)是相位。式 2中\\(A=2\\)，\\(\\omega=\\frac{1}{50}\\)(50个时间点为一个周期)，\\(\\phi=\\frac{2\\pi15}{50}=0.6\\pi\\)。\n\ncs = 2 * cos(2 * pi * (1:500) / 50 + .6 * pi)\nw = rnorm(500, 0, 1)\npar(mfrow = c(3, 1))\ntsplot(cs, ylab = \"\", main = expression(x[t] == 2 * cos(2 * pi * t / 50 + .6 * pi)))\ntsplot(cs + w, ylab = \"\", main = expression(x[t] == 2 * cos(2 * pi * t / 50 + .6 * pi) + N(0, 1)))\ntsplot(cs + 5 * w, ylab = \"\", main = expression(x[t] == 2 * cos(2 * pi * t / 50 + .6 * pi) + N(0, 25)))\n\n\n\n\n\n\n\n图 13: 余弦波和可加性高斯白噪声污染的余弦图\n\n\n\n\n\n图 13中间的图和下面的图分别加上了\\(\\sigma_w=1\\)和\\(\\sigma_w=5\\)的白噪声。信号被遮掩的程度取决于信号幅度和\\(\\sigma_w\\)的大小。信号幅度和\\(\\sigma_w\\)之比称为信噪比(signal-to-noise ratio，SNR)。SNR越大，检测信号就越容易，反之越难。例如图 13中，中间的图就比较容易看出信号，下面的图就比较困难。通常我们关心的是信号。"
  },
  {
    "objectID": "posts/time_series/index.html#平均函数",
    "href": "posts/time_series/index.html#平均函数",
    "title": "时间序列分析：第一章",
    "section": "3.1 平均函数",
    "text": "3.1 平均函数\n\\[\n\\mu_{xt}=\\operatorname{E}(x_t)=\\int_{-\\infty}^{\\infty}xf_t(x)\\operatorname{d}x\n\\tag{3}\\]\n\n3.1.1 移动平均序列的平均函数\n平均函数和白噪声相同，以图 10里的情况为例。\n白噪声序列\\(w_t\\)有\\(\\mu_{wt}=\\operatorname{E}(w_t)=0\\)，进行平滑后有\\(\\mu_{vt}=\\operatorname{E}(v_t)=\\frac{1}{3}[\\operatorname{E}(w_{t-1})+\\operatorname{E}(w_t)+\\operatorname{E}(w_{t-1})]=0\\)，平均函数不变。\n\n\n3.1.2 带漂移项的随机游走的平均函数\n平均函数为一条直线，以式 1为例。\n已知\\(\\operatorname{E}(w_t)=0\\)，\\(\\delta\\)为常数，有：\n\\[\n\\mu_{xt}=\\operatorname{E}(x_t)=\\delta t+\\sum_{j=1}^{t}\\operatorname{E}(w_j)=\\delta t\n\\]\n这是一条斜率为\\(\\delta\\)的直线，图 12中的虚线就是其平均函数。\n\n\n3.1.3 信号加噪声的平均函数\n平均函数为余弦波，以式 2为例。\n\\[\n\\mu_{xt}=\\operatorname{E}(x_t)=\\operatorname{E}[2cos(2\\pi\\frac{t+15}{50})+w_t]=2cos(2\\pi\\frac{t+15}{50})+\\operatorname{E}(w_t)=2cos(2\\pi\\frac{t+15}{50})\n\\]"
  },
  {
    "objectID": "posts/time_series/index.html#自协方差函数autocovariance-function",
    "href": "posts/time_series/index.html#自协方差函数autocovariance-function",
    "title": "时间序列分析：第一章",
    "section": "3.2 自协方差函数(Autocovariance Function)",
    "text": "3.2 自协方差函数(Autocovariance Function)\n对于任意\\(s\\)和\\(t\\)，自协方差函数被定义为二阶矩函数：\n\\[\n\\gamma_x(s,t)=\\operatorname{cov}(x_s,x_t)=\\operatorname{E}[(x_s-\\mu_s)(x_t-\\mu_t)]\n\\tag{4}\\]\n自协方差衡量在不同时间观察到的同一时间序列的两点间的线性依赖性。平滑的时间序列，即使\\(t\\)和\\(s\\)相隔很远，自协方差函数也会比较大；而波动大的时间序列，自协方差函数几乎为0。\n从经典统计数据角度来看，如果\\(\\gamma_x(s,t)=0\\)，\\(x_s\\)和\\(x_t\\)非线性相关(可能有其他依赖结构)。但如果\\(x_s\\)和\\(x_t\\)是二元正态分布，\\(\\gamma_x(s,t)=0\\)说明相互独立。对于\\(s=t\\)，自协方差就是方差，即：\n\\[\n\\gamma_x(t,t)=\\operatorname{E}[(x_t-\\mu_t)^2]=\\operatorname{var}(x_t)\n\\]\n\n3.2.1 白噪声的自协方差\n白噪声序列\\(w_t\\)有\\(\\operatorname{E}(w_t)=0\\)，且\n\\[\n\\gamma_w(s,t)=\\operatorname{cov}(w_s,w_t)=\\begin{cases}\n\\sigma_w^2 & s=t\\\\\n0 & s\\neq t\n\\end{cases}\n\\]\n\n\n3.2.2 线性组合的协方差\n我们经常要计算滤波序列之间的自协方差，可以用到下面的性质：\n如果有随机变量\n\\[\nU=\\sum_{j=1}^ma_jX_j\\ 和\\ V=\\sum_{k=1}^rb_kY_k\n\\]\n分别是随机变量\\(\\{X_j\\}\\)和\\(\\{Y_k\\}\\)的线性组合，则它们的协方差为：\n\\[\n\\operatorname{cov}(U,V)=\\sum_{j=1}^m\\sum_{k=1}^ra_jb_k\\operatorname{cov}(X_j,Y_k)\n\\]\n且\\(\\operatorname{var}(U)=\\operatorname{cov}(U,U)\\)。\n\n\n3.2.3 移动平均值的自协方差\n以小节 2.2中的例子为例。变换后的滤波序列有：\n\\[\n\\gamma_v(s,t)=\\operatorname{cov}(v_s,v_t)=\\operatorname{cov}\\{\\frac{1}{3}(w_{s-1}+w_s+w_{s+1}),\\frac{1}{3}(w_{t-1}+w_t+w_{t+1})\\}\n\\]\n当\\(s=t\\)时：\n\\[\n\\begin{aligned}\n\\gamma_v(t,t)&=\\frac{1}{9}\\operatorname{cov}\\{(w_{t-1}+w_t+w_{t+1}),(w_{t-1}+w_t+w_{t+1})\\}\\\\\n&=\\frac{1}{9}[\\operatorname{cov}(w_{t-1},w_{t-1})+\\operatorname{cov}(w_{t},w_{t})+\\operatorname{cov}(w_{t+1},w_{t+1})]\\\\\n&=\\frac{3}{9}\\sigma_w^2\n\\end{aligned}\n\\]\n当\\(s=t+1\\)时：\n\\[\n\\begin{aligned}\n\\gamma_v(t+1,t)&=\\frac{1}{9}\\operatorname{cov}\\{(w_t+w_{t+1}+w_{t+2}),(w_{t-1}+w_t+w_{t+1})\\}\\\\\n&=\\frac{1}{9}[\\operatorname{cov}(w_t,w_t)+\\operatorname{cov}(w_{t+1},w_{t+1})+\\operatorname{cov}(w_{t+2},w_{t-1})]\\\\\n&=\\frac{1}{9}[\\operatorname{cov}(w_t,w_t)+\\operatorname{cov}(w_{t+1},w_{t+1})+0]\\\\\n&=\\frac{2}{9}\\sigma_w^2\n\\end{aligned}\n\\]\n通过类似计算，我们得到\\(\\gamma_v(t-1,t)=\\gamma_v(t+1,t)=\\frac{2}{9}\\sigma_w^2\\)，\\(\\gamma_v(t-2,t)=\\gamma_v(t+2,t)=\\frac{1}{9}\\sigma_w^2\\)，当\\(|t-s|&gt;2\\)时为0。即：\n\\[\n\\gamma_v(s,t)=\\begin{cases}\n\\frac{3}{9}\\sigma_w^2&s=t\\\\\n\\frac{2}{9}\\sigma_w^2&|s-t|=1\\\\\n\\frac{1}{9}\\sigma_w^2&|s-t|=2\\\\\n0&|s-t|&gt;2\n\\end{cases}\n\\]\n平滑后序列的协方差函数随两时间点间的间隔增加而减小，其协方差只取决于时间间隔或滞后，不取决于时间点在时间序列中的绝对位置。\n\n\n3.2.4 随机游走的自协方差\n随机游走模型\\(x_t=\\sum_{j=1}^tw_j\\)，有\n\\[\n\\gamma_x(s,t)=\\operatorname{cov}(x_s,x_t)=\\operatorname{cov}(\\sum_{j=1}^sw_j,\\sum_{k=1}^tw_k)=\\operatorname{min}\\{s,t\\}\\sigma_w^2\n\\]\n随机游走的自协方差函数取决于特定的时间值\\(s\\)和\\(t\\)，不取决于时间间隔或滞后。且\\(\\operatorname{var}(x_t)=\\gamma_x(t,t)=t\\sigma_w^2\\)。"
  },
  {
    "objectID": "posts/time_series/index.html#自相关函数autocorrelation-functionacf",
    "href": "posts/time_series/index.html#自相关函数autocorrelation-functionacf",
    "title": "时间序列分析：第一章",
    "section": "3.3 自相关函数(Autocorrelation Function，ACF)",
    "text": "3.3 自相关函数(Autocorrelation Function，ACF)\n\\[\n\\rho(s,t)=\\frac{\\gamma(s,t)}{\\sqrt{\\gamma(s,s)\\gamma(t,t)}}\n\\]\nACF用来衡量序列中不同时间点之间的依赖性，常用来检测周期性、趋势和模式。\n\n3.3.1 交叉协方差函数(Cross-covariance Function)\n\\[\n\\gamma_{xy}(s,t)=\\operatorname{cov}(x_s,y_t)=\\operatorname{E}[(x_s-\\mu_{xs})(y_t-\\mu_{yt})]\n\\]\n交叉协方差函数用于衡量两个时间序列在不同滞后下的协方差。\n\n\n3.3.2 交叉相关函数(cross-correlation function，CCF)\n\\[\n\\rho_{xy}(s,t)=\\frac{\\gamma_{xy}(s,t)}{\\sqrt{\\gamma_x(s,s)\\gamma_y(t,t)}}\n\\]\nCCF用于衡量两个时间序列之间在不同滞后下的线性关系。它类似于自相关函数，但用于评估两个不同时间序列之间的相关性，而不仅仅是同一个序列的内部相关性。"
  },
  {
    "objectID": "posts/time_series/index.html#严格平稳strictly-stationary",
    "href": "posts/time_series/index.html#严格平稳strictly-stationary",
    "title": "时间序列分析：第一章",
    "section": "4.1 严格平稳(Strictly Stationary)",
    "text": "4.1 严格平稳(Strictly Stationary)\n如果时间序列每个值的集合\\(\\{x_{t_1},\\ x_{t_2},\\ \\cdots,\\ x_{t_k}\\}\\)的概率等于时间移动后值的集合\\(\\{x_{t_1+h},\\ x_{t_2+h},\\ \\cdots,\\ x_{t_k+h}\\}\\)的概率，即\n\\[\n\\Pr\\{x_{t_1}\\le c_1,\\cdots,x_{t_k}\\le c_k\\}=\\Pr\\{x_{t_1+h}\\le c_1,\\cdots,x_{t_k+h}\\le c_k\\}\n\\tag{5}\\]\n其中所有\\(k=1,\\ 2,\\ \\cdots\\)，所有时间点\\(t_1,\\ t_2,\\ \\cdots,\\ t_k\\)，所有数值\\(c_1,\\ c_2,\\ \\cdots,\\ c_k\\)和所有时间移动\\(h=0,\\ \\pm1,\\ \\pm2,\\ \\cdots\\)。\n当\\(k=1\\)时，式 5变为对任意\\(s\\)和\\(t\\)\n\\[\n\\Pr\\{x_s\\le c\\}=\\Pr\\{x_t\\le c\\}\n\\tag{6}\\]\n可见严格平稳的时间序列对于所有\\(s\\)和\\(t\\)，\\(\\mu_s=\\mu_t\\)，因此\\(\\mu_t\\)必定为常数。\n当\\(k=2\\)时，式 5又变为对任意\\(s\\)和\\(t\\)以及位移\\(h\\)\n\\[\n\\Pr\\{x_s\\le c_1,x_t\\le c_2\\}=\\Pr\\{x_{s+h}\\le c_1,x_{t+h}\\le c_2\\}\n\\tag{7}\\]\n根据式 6和式 7可推知，对任意\\(s\\)和\\(t\\)以及位移\\(h\\)\n\\[\n\\gamma(s,t)=\\gamma(s+h,t+h)\n\\]\n严格平稳的时间序列自协方差函数取决于\\(s\\)和\\(t\\)之间的时间差异，而不是具体时间点。"
  },
  {
    "objectID": "posts/time_series/index.html#弱平稳weakly-stationary",
    "href": "posts/time_series/index.html#弱平稳weakly-stationary",
    "title": "时间序列分析：第一章",
    "section": "4.2 弱平稳(Weakly Stationary)",
    "text": "4.2 弱平稳(Weakly Stationary)\n弱平稳时间序列\\(x_t\\)是一个方差有限的随机过程，满足以下条件：\n\n式 3中定义的均值函数\\(\\mu_t\\)是常数，不依赖于时间\\(t\\)；\n式 4中定义的自协方差函数\\(\\gamma(s,t)\\)仅取决于\\(s\\)和\\(t\\)的差值\\(|s-t|\\)而不是具体的\\(s\\)或者\\(t\\)的取值。\n\n\n\n\n\n\n\n提示\n\n\n\n条件1和2可推导出方差恒定，同时方差恒定和自协方差函数仅取决于时差可以推导出均值恒定，但均值恒定和方差恒定不能推导出自协方差函数仅取决于时差。\n严格平稳要求序列的所有阶矩(如均值、方差、偏度、峰度等)都不随时间变化(如抛硬币，理想情况下随时随刻抛正反面分布情况不变)，弱平稳的要求则宽松一些，只要求前两阶矩(均值、方差)恒定。\n阶矩用来衡量数据的分布情况。\n一阶矩\\(\\operatorname{E}[X]\\)衡量均值(\\(\\mu\\))；二阶矩\\(\\operatorname{E}[(X-\\mu)^2]\\)衡量方差(\\(\\sigma^2\\))；三阶矩\\(\\operatorname{E}[(X-\\mu)^3]\\)衡量偏度(\\(\\gamma_1\\))；四阶矩\\(\\operatorname{E}[(X-\\mu)^4]\\)衡量峰度(\\(\\gamma_2\\))；五阶矩表达式为\\(\\operatorname{E}[(X-\\mu)^5]\\)，衡量更高的维度。\n\n\n我们很难从单个数据集中评估出严格平稳，更多的是使用弱平稳。\n\n\n\n\n\n\n注释\n\n\n\n为了方便，之后使用平稳表示弱平稳，严平稳表示严格平稳。\n\n\n方差有限的严平稳也是弱平稳。\n\n\n\n\n\n\n注释\n\n\n\n平稳时间序列的均值\\(\\operatorname{E}(x_t)=\\mu_t\\)与时间\\(t\\)无关，方便起见用\\(\\mu\\)表示\\(\\mu_t\\)。\n平稳时间序列\\(x_t\\)的自协方差函数\\(\\gamma(s,t)\\)仅取决于时差\\(|s-t|\\)，令\\(s=t+h\\)，\\(h\\)表示时移或滞后，则\n\\[\n\\gamma(t+h,t)=\\operatorname{cov}(x_{t+h},x_t)=\\operatorname{cov}(x_h,x_0)=\\gamma(h,0)\n\\]\n方便起见简写为\\(\\gamma(h)\\)。\n\n\n平稳时间序列的自协方差函数为：\n\\[\n\\gamma(h)=\\operatorname{cov}(x_{t+h},x_t)=\\operatorname{E}[(x_{t+h}-\\mu)(x_t-\\mu)]\n\\]\n平稳时间序列的自相关函数(ACF)为：\n\\[\n\\rho(h)=\\frac{\\gamma(t+h,t)}{\\sqrt{\\gamma(t+h,t+h)\\gamma(t,t)}}=\\frac{\\gamma(h)}{\\gamma(0)}\n\\tag{8}\\]\n\n4.2.1 白噪声的平稳性\n小节 2.1和小节 2.3所展示的白噪声序列均值为\\(\\mu_{wt}=0\\)，自协方差函数为：\n\\[\n\\gamma_w(h)=\\operatorname{cov}(w_{t+h},w_t)=\\begin{cases}\n\\sigma_w^2&h=0\\\\\n0&h\\neq0\\\\\n\\end{cases}\n\\]\n白噪声为弱平稳时间序列，如果白噪声符合正态分布或高斯分布，则还是严格平稳的。因此自相关函数为\\(\\rho_w(0)=1\\)，且当\\(h\\neq0\\)时，\\(\\rho(h)=0\\)。\n\n\n\n\n\n\n提示\n\n\n\n书中似乎错误引用式 5，应该是根据式 8计算，自相关函数为： \\[\n\\rho_w(h)=\\begin{cases}\n\\frac{\\gamma_w(0)}{\\gamma_w(0)}=\\frac{\\sigma_w^2}{\\sigma_w^2}=1&h=0\\\\\n\\frac{\\gamma_w(h)}{\\gamma_w(0)}=\\frac{0}{\\sigma_w^2}=0&h\\neq0\n\\end{cases}\n\\]\n\n\n\n\n4.2.2 移动平均序列的平稳性\n小节 2.2中的三点移动平均过程是平稳的。根据小节 3.1.1和小节 3.2.3中的内容可知其均值为\\(\\mu_{vt}=0\\)，自协方差函数为：\n\\[\n\\gamma_v(h)=\\begin{cases}\n\\frac{3}{9}\\sigma_w^2&h=0\\\\\n\\frac{2}{9}\\sigma_w^2&h\\pm1\\\\\n\\frac{3}{9}\\sigma_w^2&h\\pm2\\\\\n\\frac{3}{9}\\sigma_w^2&|h|&gt;2\\\\\n\\end{cases}\n\\]\n与时间\\(t\\)无关。自相关函数为：\n\\[\n\\rho_v(h)=\\begin{cases}\n1&h=0\\\\\n\\frac{2}{3}&h\\pm1\\\\\n\\frac{1}{3}&h\\pm2\\\\\n0&|h|&gt;2\\\\\n\\end{cases}\n\\]\n其关于滞后值0对称。\n\n\n4.2.3 随机游走是非平稳的\n由小节 3.1.2和小节 3.2.4可知，随机游走的平均函数为\\(\\mu_{xt}=\\delta t\\)，自协方差函数为\\(\\gamma_x(s,t)=\\operatorname{min}\\{s,t\\}\\sigma_w^2\\)，都和时间有关，故随机游走不是平稳的。\n\n\n4.2.4 趋势平稳性(Trend Stationarity)\n趋势平稳性指模型围绕线性趋势的平稳行为，即均值函数不独立于时间，但自协方差函数独立于时间。\n如\\(x_t=\\alpha+\\beta t+y_t\\)，其中\\(y_t\\)是平稳的，则均值函数为\\(\\mu_{x,t}=\\operatorname{E}(x_t)=\\alpha+\\beta t+\\mu_y\\)，不独立于时间；自协方差函数为\\(\\gamma_x(h)=\\operatorname{cov}(x_{t+h},x_t)=\\operatorname{E}[(x_{t+h}-\\mu_{x,t+h})(x_t-\\mu_{x,t})]=\\operatorname{E}[(y_{t+h}-\\mu_y)(y_t-\\mu_y)]=\\gamma_y(h)\\)，独立于时间。\n例子如图 14所示。\n\n\n\n\n\n\n\n\n图 14: 鸡肉价格\n\n\n\n\n\n这种数据有以下几个特殊属性：\n\n\\(\\gamma(h)\\)非负；\n\\(\\gamma(0)=\\operatorname{E}[(x_t-\\mu)^2]\\)；\n自协方差函数关于原点对称，\\(\\gamma(h)=\\gamma(-h)\\)。"
  },
  {
    "objectID": "posts/time_series/index.html#联合平稳jointly-stationary",
    "href": "posts/time_series/index.html#联合平稳jointly-stationary",
    "title": "时间序列分析：第一章",
    "section": "4.3 联合平稳(Jointly Stationary)",
    "text": "4.3 联合平稳(Jointly Stationary)\n两个时间序列\\(x_t\\)和\\(y_t\\)均是平稳的，且它们的交叉协方差函数为：\n\\[\n\\gamma_{xy}(h)=\\operatorname{cov}(x_{t+h},y_t)=\\operatorname{E}[(x_{t+h}-\\mu_x)(y_t-\\mu_y)]\n\\]\n我们称\\(x_t\\)和\\(y_t\\)是联合平稳的，且交叉协方差函数仅和滞后值\\(h\\)有关。\n\n4.3.1 交叉相关函数(Cross-Correlation Function，CCF)\n联合平稳时间序列\\(x_t\\)和\\(y_t\\)的交叉相关函数为：\n\\[\n\\rho_{xy}(h)=\\frac{\\gamma_{xy}(h)}{\\sqrt{\\gamma_x(0)\\gamma_y(0)}}\n\\tag{9}\\]\n其交叉相关函数通常关于0不对称，即\\(\\rho_{xy}(h)\\neq \\rho_{xy}(-h)\\)，即\\(\\operatorname{cov}(x_2,y_1)\\)和\\(\\operatorname{cov}(x_1,y_2)\\)不必相同。\n但\\(\\rho_{xy}(h)=\\rho_{yx}(-h)\\)\n\n\n\n\n\n\n提示\n\n\n\n这里给出推导过程。\n\\(\\rho_{xy}(h)\\neq \\rho_{xy}(-h)\\)是因为：\n\\[\n\\rho_{xy}(h)=\\frac{\\gamma_{xy}(h)}{\\sqrt{\\gamma_x(0)\\gamma_y(0)}}\n\\]\n和\n\\[\n\\rho_{xy}(-h)=\\frac{\\gamma_{xy}(-h)}{\\sqrt{\\gamma_x(0)\\gamma_y(0)}}\n\\]\n中，\\(\\gamma_{xy}(h)\\neq \\gamma_{xy}(-h)\\)，即：\n\\[\n\\operatorname{cov}(x_{t+h},y_t)\\neq\\operatorname{cov}(x_t,y_{t+h})\n\\]\n\\(\\rho_{xy}(h)=\\rho_{yx}(-h)\\)是因为：\n\\[\n\\rho_{yx}(-h)=\\frac{\\gamma_{yx}(-h)}{\\sqrt{\\gamma_y(0)\\gamma_x(0)}}\n\\]\n根据协方差的性质：\n\\[\n\\operatorname{cov}(x_t,y_{t+h})=\\operatorname{E}[(x_t-\\mu_x)(y_{t+h}-\\mu_y)]=\\operatorname{E}[(y_{t+h}-\\mu_y)(x_t-\\mu_x)]=\\operatorname{cov}(y_{t+h},x_t)\n\\]\n即：\n\\[\n\\operatorname{cov}(A,B)=\\operatorname{cov}(B,A)\n\\]\n可得：\n\\[\n\\gamma_{yx}(-h)=\\operatorname{cov}(y_{t-h},x_t)=\\operatorname{cov}(x_t,y_{t-h})=\\gamma_{xy}(h)\n\\]\n\n\n\n\n4.3.2 联合平稳性(Joint Stationarity)\n两个序列\\(x_t\\)和\\(y_t\\)，分别是白噪声过程两个连续值的和与差，即\\(x_t=w_t+w_{t-1}\\)和\\(y_t=w_t-w_{t-1}\\)，其中\\(w_t\\)是均值为0，方差为\\(\\sigma_w^2\\)的独立随机变量。易证\\(\\gamma_x(0)=\\gamma_y(0)=2\\sigma_w^2\\)，以及\\(\\gamma_x(1)=\\gamma_y(-1)=\\sigma_w^2\\)、\\(\\gamma_y(1)=\\gamma_x(-1)=-\\sigma_w^2\\)。\n同时有：\n\\[\n\\gamma_{xy}(1)=\\operatorname{cov}(x_{t+1},y_t)=\\operatorname{cov}(w_{t+1}+w_t,w_t-w_{t-1})=\\sigma_w^2\n\\tag{10}\\]\n类似的：\\(\\gamma_{xy}(0)=0\\)、\\(\\gamma_{xy}(-1)=-\\sigma_w^2\\)。根据式 9，可得：\n\\[\n\\rho_{xy}(h)=\\begin{cases}\n0&h=0\\\\\n1/2&h=1\\\\\n-1/2&h=-1\\\\\n0&|h|\\ge2\n\\end{cases}\n\\]\n自协方差和交叉协方差函数仅取决于滞后值\\(h\\)，因此序列是联合平稳的。\n\n\n\n\n\n\n提示\n\n\n\n给出补充的推导过程帮助记忆和理解。\n注意：\\(\\gamma_{xy}(h)\\)等于\\(\\operatorname{cov}(x_{t+h},y_t)\\)，而不是等于\\(\\operatorname{cov}(x_t,y_{t+h})\\)，在自协方差里面混淆了不影响结果，但在交叉协方差里面是有影响的。\n\n方差\n\n因为是独立随机变量，所以\\(\\operatorname{cov}(w_t,w_{t-1})=0\\)，所以：\n\\[\n\\gamma_x(0)=\\operatorname{var}(x_t)=\\operatorname{var}(w_t+w_{t-1})=\\operatorname{var}(w_t)+\\operatorname{var}(w_{t-1})+2\\operatorname{cov}(w_t,w_{t-1})=2\\sigma_w^2\n\\]\n同理：\n\\[\n\\gamma_y(0)=\\operatorname{var}(y_t)=\\operatorname{var}(w_t-w_{t-1})=\\operatorname{var}(w_t)+\\operatorname{var}(w_{t-1})-2\\operatorname{cov}(w_t,w_{t-1})=2\\sigma_w^2\n\\]\n\n滞后自协方差\n\n\\[\n\\begin{aligned}\n\\gamma_x(1)=\\operatorname{cov}(x_{t+1},x_t)\n&=\\operatorname{cov}(w_{t+1}+w_t,w_t+w_{t-1})\\\\\n&=\\operatorname{cov}(w_{t+1},w_t)+\\operatorname{cov}(w_{t+1},w_{t-1})+\\operatorname{cov}(w_t,w_t)+\\operatorname{cov}(w_t,w_{t-1})\\\\\n&=0+0+\\sigma_w^2+0\\\\\n&=\\sigma_w^2\n\\end{aligned}\n\\]\n类似的：\n\\[\n\\begin{aligned}\n\\gamma_y(1)=\\operatorname{cov}(y_{t+1},y_t)\n&=\\operatorname{cov}(w_{t+1}-w_t,w_t-w_{t-1})\\\\\n&=\\operatorname{cov}(w_{t+1},w_t)-\\operatorname{cov}(w_{t+1},w_{t-1})-\\operatorname{cov}(w_t,w_t)+\\operatorname{cov}(w_t,w_{t-1})\\\\\n&=0-0-\\sigma_w^2+0\\\\\n&=-\\sigma_w^2\n\\end{aligned}\n\\]\n\n自协方差\n\n\\[\n\\gamma_x(h)=\\begin{cases}\n2\\sigma_w^2&h=0\\\\\n\\sigma_w^2&|h|=1\\\\\n0&|h|\\ge2\\\\\n\\end{cases}\n\\]\n\\[\n\\gamma_y(h)=\\begin{cases}\n2\\sigma_w^2&h=0\\\\\n-\\sigma_w^2&|h|=1\\\\\n0&|h|\\ge2\\\\\n\\end{cases}\n\\]\n交叉相关函数是在式 10的基础上，简单的公式代入，不做补充推导。\n\n\n\n\n4.3.3 使用交叉相关进行预测\n有模型：\n\\[\ny_t=Ax_{t-\\ell}+w_t\n\\]\n前导(lead)：当\\(\\ell&gt;0\\)时，序列\\(x_t\\)是序列\\(y_t\\)的前导；\n滞后(lag)：当\\(\\ell&lt;0\\)时，序列\\(x_t\\)是序列\\(y_t\\)的滞后。\n在用\\(x_t\\)预测\\(y_t\\)时，判断清楚前导和滞后关系很重要。\n假设噪声\\(w_t\\)和\\(x_t\\)不相关，则交叉协方差函数如下：\n\\[\n\\begin{aligned}\n\\gamma_{yx}(h)\n&=\\operatorname{cov}(y_{t+h},x_t)=\\operatorname{cov}(Ax_{t+h-\\ell}+w_{t+h},x_t)\\\\\n&=\\operatorname{cov}(Ax_{t+h-\\ell},x_t)=A\\gamma_x(h-\\ell)\n\\end{aligned}\n\\]\n根据柯西不等式(Cauchy-Schwarz)，当\\(h=\\ell\\)时，即\\(\\gamma_x(0)\\)时，\\(\\gamma_{yx}(h)\\)取最大绝对值。如果\\(h&gt;0\\)时取最大绝对值，说明\\(x_t\\)是\\(y_t\\)的先导；如果\\(h&lt;0\\)时取最大绝对值，说明\\(x_t\\)滞后于\\(y_t\\)。\n\n\n\n\n\n\n提示\n\n\n\n因为是相关，不涉及因果，所以先导和滞后都是相对的。\n考虑到标准差一般为固定值，协方差最大的时候，就是\\(x_t\\)和\\(y_t\\)相关性最强的时候。\n\n\n\nset.seed(2)\nx = rnorm(100)\ny = stats::lag(x, -5) + rnorm(100) # h = 5\nastsa::ccf2(y, x, ylab = 'CCovF', type = 'covariance')\ntext( 9, 1.1, 'x leads')\ntext(-8, 1.1, 'y leads')\n\n\n\n\n\n\n\n图 15: 交叉协方差函数"
  },
  {
    "objectID": "posts/time_series/index.html#线性随机过程linear-process",
    "href": "posts/time_series/index.html#线性随机过程linear-process",
    "title": "时间序列分析：第一章",
    "section": "4.4 线性(随机)过程(Linear Process)",
    "text": "4.4 线性(随机)过程(Linear Process)\n\\(x_t\\)是白噪声\\(w_t\\)的线性组合，具体如下：\n\\[\nx_t=\\mu+\\sum_{j=-\\infty}^{\\infty}\\psi_jw_{t-j},\\ \\sum_{j=-\\infty}^{\\infty}|\\psi_j|&lt;\\infty\n\\tag{11}\\]\n当\\(h\\ge0\\)时，其自协方差函数为：\n\\[\n\\gamma_x(h)=\\sigma_w^2\\sum_{j=-\\infty}^{\\infty}\\psi_{j+h}\\psi_j\n\\tag{12}\\]\n\n\n\n\n\n\n提示\n\n\n\n\n模型解释\n\n式 11表示一种广义的线性随机过程。\n\\[\nx_t=\\mu+\\sum_{j=-\\infty}^{\\infty}\\psi_jw_{t-j},\\ \\sum_{j=-\\infty}^{\\infty}|\\psi_j|&lt;\\infty\n\\]\n其中：\n\n\\(x_t\\)：当前时间点\\(t\\)的观测值；\n\\(\\mu\\)：序列的均值；\n\\(\\psi_j\\)：权重系数，描述了过去(\\(j&gt;0\\))、现在(\\(j=0\\))和未来(\\(j &lt; 0\\))的随机扰动对当前观测值的影响；\n\\(w_t\\)：随机扰动项。\n\n\n自协方差函数推导\n\n\\[\n\\gamma_x(h)=\\operatorname{cov}(x_{t+h},x_t)\n\\]\n将给定的\\(x_t\\)代入：\n\\[\n\\begin{aligned}\n\\gamma_x(h)\n&=\\operatorname{cov}(\\mu+\\sum_{j=-\\infty}^{\\infty}\\psi_jw_{t+h-j},\\mu+\\sum_{k=-\\infty}^{\\infty}\\psi_kw_{t-k})\\\\\n&=\\operatorname{cov}(\\sum_{j=-\\infty}^{\\infty}\\psi_jw_{t+h-j},\\sum_{k=-\\infty}^{\\infty}\\psi_kw_{t-k})\\\\\n&=\\sum_{j=-\\infty}^{\\infty}\\sum_{k=-\\infty}^{\\infty}\\psi_j\\psi_k\\operatorname{cov}(w_{t+h-j},w_{t-k})\n\\end{aligned}\n\\]\n当\\(k=j-h\\)时，\\(\\operatorname{cov}(w_{t+h-j},w_{t-k})=\\sigma_w^2\\)；\n当\\(k\\neq j-h\\)时，\\(\\operatorname{cov}(w_{t+h-j},w_{t-k})=0\\)。\n因此，非零项只发生在\\(k=j-h\\)处，表达式可简化为：\n\\[\n\\gamma_x(h)=\\sigma_w^2\\sum_{j=-\\infty}^{\\infty}\\psi_j\\psi_{j-h}\n\\]\n这和式 12是一致的。\n\n\n\n\n\n\n\n\n提示\n\n\n\n正态时间序列(高斯时间序列)之后也会涉及，目前来看在理解上没那么重要，如有需求会在后续补上。"
  },
  {
    "objectID": "posts/time_series/index.html#样本自协方差函数sample-autocovariance-function",
    "href": "posts/time_series/index.html#样本自协方差函数sample-autocovariance-function",
    "title": "时间序列分析：第一章",
    "section": "5.1 样本自协方差函数(Sample Autocovariance Function)",
    "text": "5.1 样本自协方差函数(Sample Autocovariance Function)\n\\[\n\\hat\\gamma(h)=n^{-1}\\sum_{t=1}^{n-h}(x_{t+h}-\\bar x)(x_t-\\bar x)\n\\]\n其中\\(h=0,1,\\cdots,n-1\\)，且\\(\\hat\\gamma(-h)=\\hat\\gamma(h)\\)。"
  },
  {
    "objectID": "posts/time_series/index.html#样本自相关函数sample-autocorrelation-function",
    "href": "posts/time_series/index.html#样本自相关函数sample-autocorrelation-function",
    "title": "时间序列分析：第一章",
    "section": "5.2 样本自相关函数(Sample Autocorrelation Function)",
    "text": "5.2 样本自相关函数(Sample Autocorrelation Function)\n\\[\n\\hat\\rho(h)=\\frac{\\hat\\gamma(h)}{\\hat\\gamma(0)}\n\\]\n使用小节 1.5中的SOI序列数据，展示不同滞后下得到的不同估计相关系数，以及其散点图。图片左上角为估计相关系数。\n\nr = round(acf1(soi, 6, plot = FALSE), 2) # sample acf values\npar(mfrow = c(1, 2))\ntsplot(stats::lag(soi, -1), soi, col = 4, type = 'p', xlab = 'lag(soi,-1)')\n legend(\"topleft\", legend = r[1], bg = \"white\", adj = .45, cex = 0.85)\ntsplot(stats::lag(soi, -6), soi, col = 4, type = 'p', xlab = 'lag(soi,-6)')\n legend(\"topleft\", legend = r[6], bg = \"white\", adj = .25, cex = 0.8)\n\n\n\n\n\n\n\n图 16: SOI序列与其滞后1个月(左)和滞后6个月(右)的相关散点图\n\n\n\n\n\n如果在大样本下，样本ACF近似服从正态分布，该正态分布均值为0，标准差为\\(\\frac{1}{\\sqrt{n}}\\)。\n在此基础上，我们还是可以根据\\(\\hat\\rho(h)\\)是否在95%置信区间外来检验显著性。\n通过模拟数据，我们来验证一下是不是大样本数据估计出来的ACF更接近理论值。\n用抛硬币的方法构建一组数据\\(x_t\\)，硬币正面令\\(x_t=1\\)，反面令\\(x_t=-1\\)。然后构建\\(y_t=5+x_t-0.7x_{t-1}\\)。\n\nset.seed(666)\nx1 = sample(c(-1,1), 11, replace=TRUE)  # simulated sequence of coin tosses\nx2 = sample(c(-1,1), 1001, replace=TRUE)\ny1 = 5 + stats::filter(x1, sides=1, filter=c(1,-.7))[-1]\ny2 = 5 + stats::filter(x2, sides=1, filter=c(1,-.7))[-1]\nc(mean(y1), mean(y2))  # the sample means\n\n[1] 4.8600 5.0018\n\nacf(y1, lag.max=4, plot=FALSE) \n\n\nAutocorrelations of series 'y1', by lag\n\n     0      1      2      3      4 \n 1.000 -0.226 -0.630  0.221  0.419 \n\nacf(y2, lag.max=4, plot=FALSE)\n\n\nAutocorrelations of series 'y2', by lag\n\n     0      1      2      3      4 \n 1.000 -0.474 -0.003  0.001 -0.008 \n\n\n计算一下理论值。\n\\(x_t\\)均值为0，方差为1，则\\(y_t\\)有：\n\\[\n\\rho_x(1)=\\frac{-0.7}{1+0.7^2}\\approx-0.47\n\\]\n可见样本更大的更接近理论值。\n\n\n\n\n\n\n提示\n\n\n\n理论值的推导。\n\\[\n\\begin{aligned}\n\\gamma_y(h)&=\\operatorname{cov}(y_{t+h},y_t)=\\operatorname{cov}(5+x_{t+h}-0.7x_{t+h-1},5+x_t-0.7x_{t-1})\\\\\n&=\\operatorname{cov}(x_{t+h}-0.7x_{t+h-1},x_t-0.7x_{t-1})\\\\\n&=\\operatorname{cov}(x_{t+h},x_t)-0.7\\operatorname{cov}(x_{t+h},x_{t-1})-0.7\\operatorname{cov}(x_{t+h-1},x_t)+0.49\\operatorname{cov}(x_{t+h-1},x_{t-1})\n\\end{aligned}\n\\]\n\\(x_t\\)是均值为0，方差为1的独立同分布，所以当\\(h=0\\)时，\\(\\operatorname{cov}(x_t,x_t)=\\operatorname{var}(x_t)=1\\)；当\\(h\\neq0\\)时，\\(\\operatorname{cov}(x_t,x_{t+h})=0\\)\n所以：\n\\[\n\\gamma_y(h)=\\begin{cases}\n1-0-0+0.49=1.49&h=0\\\\\n0-0-0.7+0=0.7&h=1\\\\\n0-0-0+0=0&h\\ge2\n\\end{cases}\n\\]\n所以：\n\\[\n\\rho_y(1)=\\frac{\\gamma_y(1)}{\\gamma_y(0)}=\\frac{-0.7}{1+0.7^2}\\approx-0.47\n\\]\n\n\n再展示小节 1.3的ACF图。\n\nacf1(speech, 250)\n\n\n\n\n\n\n\n图 17: 语音数据的ACF\n\n\n\n\n\n可见每隔100多点的间隔，峰值重复出现，说明这可能是一系列重复的短信号。"
  },
  {
    "objectID": "posts/time_series/index.html#样本交叉协方差函数",
    "href": "posts/time_series/index.html#样本交叉协方差函数",
    "title": "时间序列分析：第一章",
    "section": "5.3 样本交叉协方差函数",
    "text": "5.3 样本交叉协方差函数\n\\[\n\\hat\\gamma_{xy}(h)=n^{-1}\\sum_{t=1}^{n-h}(x_{t+h}-\\bar x)(y_t-\\bar y)\n\\]"
  },
  {
    "objectID": "posts/time_series/index.html#样本交叉相关函数",
    "href": "posts/time_series/index.html#样本交叉相关函数",
    "title": "时间序列分析：第一章",
    "section": "5.4 样本交叉相关函数",
    "text": "5.4 样本交叉相关函数\n\\[\n\\hat\\rho_{xy}(h)=\\frac{\\hat\\gamma_{xy}(h)}{\\sqrt{\\hat\\gamma_x(0)\\hat\\gamma_y(0)}}\n\\]\n如果至少有一个过程是独立的白噪声，则\\(\\hat\\rho_{xy}(h)\\)的大样本分布是正态的，均值为0，标准差\\(\\sigma_{\\hat\\rho_(xy)}=\\frac{1}{\\sqrt{n}}\\)\n还是用小节 1.5中的数据举例。\n\npar(mfrow=c(3,1))\nacf1(soi, main=\"SOI\")\nacf1(rec, main=\"新鱼数量\")\nccf2(soi, rec, main=\"SOI vs 新鱼数量\")\n\n\n\n\n\n\n\n图 18: SOI序列(上图)和新鱼数量序列(中图)的ACF,以及它们的CCF(下图)\n\n\n\n\n\n图 18上图和中图表明12个月的间隔表现出正相关，6个月的间隔表现出负相关。下图则表现出两组数据的一些偏移，在\\(h=-6\\)处取得峰值，说明时间\\(t-6\\)测量的SOI和时间\\(t\\)的新鱼数量相关。可以说SOI领先新鱼数量6个月，且SOI的增加可能导致新鱼数量减少。虚线表示\\(\\pm2/\\sqrt{453}\\)，但现在没有意义，因为两个序列都不是白噪声。"
  },
  {
    "objectID": "posts/time_series/index.html#预白化prewhitening和交叉相关分析",
    "href": "posts/time_series/index.html#预白化prewhitening和交叉相关分析",
    "title": "时间序列分析：第一章",
    "section": "5.5 预白化(Prewhitening)和交叉相关分析",
    "text": "5.5 预白化(Prewhitening)和交叉相关分析\n白化是指将一个时间序列转换为白噪声序列的过程，也就是去除其相关性，生成一个没有自相关性的序列，便于之后进行统计分析。\n\nset.seed(1492)\nnum = 120\nt = 1:num\nX = ts(2 * cos(2 * pi * t / 12) + rnorm(num), freq = 12)\nY = ts(2 * cos(2 * pi * (t + 5) / 12) + rnorm(num), freq = 12)\nYw = resid(lm(Y ~ cos(2 * pi * t / 12) + sin(2 * pi * t / 12), na.action = NULL))\npar(mfrow = c(3, 2))\ntsplot(X)\ntsplot(Y)\nacf1(X, 48, ylab = 'ACF(X)')\nacf1(Y, 48, ylab = 'ACF(Y)')\nccf2(X, Y, 24)\nccf2(X, Yw, 24, ylim = c(-.6, .6))\n\n\n\n\n\n\n\n图 19: 白化处理展示"
  },
  {
    "objectID": "posts/time_series/index.html#向量值vector-valued和多维序列multidimensional-series",
    "href": "posts/time_series/index.html#向量值vector-valued和多维序列multidimensional-series",
    "title": "时间序列分析：第一章",
    "section": "5.6 向量值(Vector-Valued)和多维序列(Multidimensional Series)",
    "text": "5.6 向量值(Vector-Valued)和多维序列(Multidimensional Series)\n当考虑多个变量的时间序列之间的关系时，经常用向量的方法表示，即\\(x_t=(x_{t1},x_{t2},\\cdots,x_{tp})'\\)，这表示\\(p\\)个一元时间序列，是个\\(p\\times1\\)的列向量。\n平稳情况下均值为：\n\\[\n\\mu=\\operatorname{E}(x_t)=(\\mu_{t1},\\mu_{t2},\\cdots,\\mu_{tp})'\n\\]\n\\(p\\times p\\)协方差矩阵为：\n\\[\n\\mathbf{\\Gamma}(h)=\\operatorname{E}[(x_{x+h}-\\mu)(x_t-\\mu)']=\\begin{bmatrix}\n\\gamma_{11}(h)&\\gamma_{12}(h)&\\cdots&\\gamma_{1p}(h)\\\\\n\\gamma_{21}(h)&\\gamma_{22}(h)&\\cdots&\\gamma_{2p}(h)\\\\\n\\vdots&\\vdots&\\ddots&\\vdots\\\\\n\\gamma_{p1}(h)&\\gamma_{p2}(h)&\\cdots&\\gamma_{pp}(h)\\\\\n\\end{bmatrix}\n\\]\n因为\\(\\gamma_{ij}(h)=\\gamma_{ji}(-h)\\)，所有\\(\\mathbf{\\Gamma}(h)=\\mathbf{\\Gamma}'(-h)\\)。\n样本自协方差矩阵为：\n\\[\n\\hat{\\mathbf{\\Gamma}}(h)=n^{-1}\\sum_{t=1}^{n-h}(x_{t+h}-\\bar x)(x_t-\\bar x)'\n\\]\n有时候\\(x_t\\)本身就是个多维数据(如坐标)。\n图 20展示的就是一块\\(64\\times36\\)分割的土地上温度。\\(x_s=x_{s1,s2}\\)表示\\(s_1\\)行\\(s_2\\)列的温度。\n\npar(mar = rep(1, 4))\npersp(\n    1:64,          # x轴范围\n    1:36,          # y轴范围\n    soiltemp,      # 数据集\n    phi = 30,      # X-Y平面角度\n    theta = 30,    # X-Z平面角度\n    scale = FALSE, # 数据标准化，Z轴的自动缩放\n    expand = 4,    # 图的扩展比例\n    ticktype = \"detailed\",  # 刻度线类型\n    xlab = \"rows\",\n    ylab = \"cols\",\n    zlab = \"temperature\"\n)\n\n\n\n\n\n\n\n图 20: 坐标上的温度序列\n\n\n\n\n\n图中可以看出，从第\\(40\\)行开始，温度沿着行坐标开始有平稳波动。对36列进行平均，绘制行均值图 21。\n\ntsplot(rowMeans(soiltemp), xlab = \"row\", ylab = \"Average Temperature\")\n\n\n\n\n\n\n\n图 21: 行均值\n\n\n\n\n\n可发现前面40行的噪声被平滑掉了，整体是一个稳定的温度信号。\n可将一个平稳多维随机过程\\(x_s\\)的自协方差函数定义为多维滞后向量\\(h=(h_1,h_2,\\cdots,h_r)'\\)的一个函数,即：\n\\[\n\\gamma(h)=\\operatorname{E}[(x_{s+h}-\\mu)(x_s-\\mu)]\n\\]\n迁移到坐标上就是：\n\\[\n\\gamma(h_1,h_2)=\\operatorname{E}[(x_{s_1+h_1,s_2+h_2}-\\mu)(x_{s_1,s_2}-\\mu)]\n\\]\n表示行方向滞后\\(h_1\\)，列方向滞后\\(h_2\\)的自协方差函数。\n多维样本自协方差函数为：\n\\[\n\\hat\\gamma(h)=(S_1S_2\\cdots S_r)^{-1}\\sum_{s_1}\\sum_{s_2}\\cdots\\sum_{s_r}(x_{s+h}-\\bar x)(x_s-\\bar x)\n\\]\n其中：\n\\[\n\\bar x=(S_1S_2\\cdots S_r)^{-1}\\sum_{s_1}\\sum_{s_2}\\cdots\\sum_{s_r}x_{s_1,s_2,\\cdots,s_r}\n\\]\n样本自相关函数为：\n\\[\n\\hat\\rho(h)=\\frac{\\hat\\gamma(h)}{\\hat\\gamma(0)}\n\\]\n\n\n\n\n\n\n提示\n\n\n\n后面示例在之后也会出现，暂时放下。"
  }
]