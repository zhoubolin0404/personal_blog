{
  "hash": "cf13a320b9e14ecd009c7faf34a052ab",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"时间序列分析：第一章习题答案\"\nauthor: \"周博霖\"\ndate: \"2024/9/7\"\ncategories: [学习笔记,统计方法,时间序列分析]\nimage: \"cover.png\"\nbibliography: references.bib\ncsl: apa.csl\nnumber-sections: true\ntoc: true\ntoc-depth: 2\n---\n\n\n主要参考书籍为Shumway和Stoffer[-@Shumway_2017]的Time Series Analysis and Its Applications: With R Examples。\n\n该书第五版正在制作，配套`astsa`包中的部分数据集会逐渐更新，所以后期也许会换成第五版内容。\n\n该内容为第一章的习题答案，基于个人习惯，使用的大多数是`tidyverse`系列代码，会和之前学习笔记中的代码习惯有所不同。\n\n::: callout-tip\n提示框表明这部分完全是个人理解，可能有误。\n\n一切错误和想讨论的内容欢迎联系邮箱(zhoubolin0404@126.com)，感谢！\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(astsa)\n```\n:::\n\n\n\n# 1.1节\n\n## 1.1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 将EQ5和EXP6转换为数据框并合并\ndata <- data.frame(\n    time = 1:length(EQ5),\n    Earthquake = EQ5,\n    Explosion = EXP6\n) %>%\n    pivot_longer(\n        cols = c(\"Earthquake\", \"Explosion\"),\n        names_to = \"type\",\n        values_to = \"value\"\n    )\n\n# 绘图\nggplot(data, aes(x = time, y = value, color = type)) +\n  geom_line() +\n  labs(y = \"Amplitude\", x = \"Time\", title = \"Earthquake vs Explosion Signals\") +\n  scale_color_manual(values = c(\"black\", \"red\")) +\n  theme_minimal() +\n  theme(legend.position = \"top\") +\n  guides(color = guide_legend(title = NULL, override.aes = list(linetype = 1)))\n```\n\n::: {.cell-output-display}\n![](Chapter_1_sol_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n爆炸信号消失得更快，早期振幅更大。\n\n## 1.2\n\n(a)和(c)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(44)\ns_a <- c(rep(0, 100), 10 * exp(-(101:200 - 100) / 20) * cos(2 * pi * 101:200 / 4))\nx_a = s_a + rnorm(200)\ndecay_line_a = c(rep(0, 100), 10 * exp(-(1:100) / 20))\ndata_a <- as_tibble(x_a) %>%\n    mutate(time = 1:200, decay_line = decay_line_a)\nggplot(data_a, aes(x = time)) +\n    geom_line(aes(y = value), color = \"black\") +\n    geom_line(aes(y = decay_line), color = \"red\") +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Chapter_1_sol_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n(b)和(c)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(44)\ns_b = c(rep(0, 100), 10 * exp(-(101:200 - 100) / 200) * cos(2 * pi * 101:200 / 4))\nx_b = s_b + rnorm(200)\ndecay_line_b = c(rep(0, 100), 10 * exp(-(1:100) / 200))\ndata_b <- as_tibble(x_b) %>%\n    mutate(time = 1:200, decay_line = decay_line_b)\nggplot(data_b, aes(x = time)) +\n    geom_line(aes(y = value), color = \"black\") +\n    geom_line(aes(y = decay_line), color = \"red\") +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Chapter_1_sol_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n# 1.2节\n\n## 1.3\n\n(a)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(44)\nw = rnorm(150, 0, 1)\nx = stats::filter(w, filter = c(0, -0.9), method = \"recursive\")[-(1:50)]\nx2 = 2 * cos(2 * pi * (1:100) / 4)\nx3 = x2 + rnorm(100, 0, 1)\n\n# 计算移动平均线\nv = stats::filter(x, rep(1, 4) / 4, sides = 1)\nv2 = stats::filter(x2, rep(1, 4) / 4, sides = 1)\nv3 = stats::filter(x3, rep(1, 4) / 4, sides = 1)\n\n# 创建数据框\ndata <- tibble(\n    time = rep(1:100, 3),\n    ar_value = c(x, x2, x3),\n    ma_value = c(v, v2, v3),\n    type = rep(c(\n        \"autoregression\", \"sinusoid\", \"sinusoid + noise\"\n    ), each = 100)\n) %>%\n    pivot_longer(\n        cols = c(\"ar_value\", \"ma_value\"),\n        names_to = \"series\",\n        values_to = \"value\"\n    )\n\n# 使用 ggplot2 绘图\nggplot(data, aes(\n    x = time,\n    y = value,\n    color = series,\n    linetype = series\n)) +\n    geom_line() +\n    facet_wrap(~ type, ncol = 1) +\n    labs(y = \"Value\", x = \"Time\", title = \"Time Series and Moving Averages\") +\n    scale_color_manual(values = c(\"blue\", \"red\")) +\n    scale_linetype_manual(values = c(\"solid\", \"dashed\")) +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Chapter_1_sol_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::",
    "supporting": [
      "Chapter_1_sol_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}