{"title":"时间序列分析：第一章习题答案","markdown":{"yaml":{"title":"时间序列分析：第一章习题答案","author":"周博霖","date":"2024/9/7","categories":["学习笔记","统计方法","时间序列分析"],"image":"cover.png","bibliography":"references.bib","csl":"apa.csl","toc":true,"toc-depth":2},"headingText":"1.1小节","containsRefs":false,"markdown":"\n\n主要参考书籍为Shumway和Stoffer[-@Shumway_2017]的Time Series Analysis and Its Applications: With R Examples。\n\n该书第五版正在制作，配套`astsa`包中的部分数据集会逐渐更新，所以后期也许会换成第五版内容。\n\n该内容为第一章的习题答案，基于个人习惯，使用的大多数是`tidyverse`系列代码，会和之前学习笔记中的代码习惯有所不同。\n\n::: callout-tip\n提示框表明这部分完全是个人理解，可能有误。\n\n一切错误和想讨论的内容欢迎联系邮箱(zhoubolin0404@126.com)，感谢！\n:::\n\n```{r,warning=FALSE,message=FALSE}\nlibrary(tidyverse)\nlibrary(astsa)\nlibrary(cowplot)\n```\n\n\n\n## 1.1\n\n```{r}\ndata <- data.frame(\n    time = 1:length(EQ5),\n    Earthquake = EQ5,\n    Explosion = EXP6\n) %>%\n    pivot_longer(\n        cols = c(\"Earthquake\", \"Explosion\"),\n        names_to = \"type\",\n        values_to = \"value\"\n    )\n\nggplot(data, aes(x = time, y = value, color = type)) +\n    geom_line() +\n    labs(y = \"Amplitude\", x = \"Time\", title = \"Earthquake vs Explosion Signals\") +\n    scale_color_manual(values = c(\"black\", \"red\")) +\n    theme_minimal() +\n    theme(legend.position = \"top\") +\n    guides(color = guide_legend(title = NULL, override.aes = list(linetype = 1)))\n```\n\n爆炸信号消失得更快，早期振幅更大。\n\n## 1.2\n\n(a)和(c)\n\n```{r}\nset.seed(44)\ns_a <- c(rep(0, 100), 10 * exp(-(101:200 - 100) / 20) * cos(2 * pi * 101:200 / 4))\nx_a = s_a + rnorm(200)\ndecay_line_a = c(rep(0, 100), 10 * exp(-(1:100) / 20))\ndata_a <- as_tibble(x_a) %>%\n    mutate(time = 1:200, decay_line = decay_line_a)\nggplot(data_a, aes(x = time)) +\n    geom_line(aes(y = value), color = \"black\") +\n    geom_line(aes(y = decay_line), color = \"red\") +\n    theme_minimal()\n```\n\n(b)和(c)\n\n```{r}\nset.seed(44)\ns_b = c(rep(0, 100), 10 * exp(-(101:200 - 100) / 200) * cos(2 * pi * 101:200 / 4))\nx_b = s_b + rnorm(200)\ndecay_line_b = c(rep(0, 100), 10 * exp(-(1:100) / 200))\ndata_b <- as_tibble(x_b) %>%\n    mutate(time = 1:200, decay_line = decay_line_b)\nggplot(data_b, aes(x = time)) +\n    geom_line(aes(y = value), color = \"black\") +\n    geom_line(aes(y = decay_line), color = \"red\") +\n    theme_minimal()\n```\n\n# 1.2小节\n\n## 1.3\n\n(a)-(c)\n\n```{r,warning=FALSE}\nset.seed(44)\nw = rnorm(150, 0, 1)\nx = stats::filter(w, filter = c(0, -0.9), method = \"recursive\")[-(1:50)]\nx2 = 2 * cos(2 * pi * (1:100) / 4)\nx3 = x2 + rnorm(100, 0, 1)\n\nv = stats::filter(x, rep(1, 4) / 4, sides = 1)\nv2 = stats::filter(x2, rep(1, 4) / 4, sides = 1)\nv3 = stats::filter(x3, rep(1, 4) / 4, sides = 1)\n\ndata <- tibble(\n    time = rep(1:100, 3),\n    x_value = c(x, x2, x3),\n    v_value = c(v, v2, v3),\n    type = rep(c(\n        \"autoregression\", \"sinusoid\", \"sinusoid + noise\"\n    ), each = 100)\n) %>%\n    pivot_longer(\n        cols = c(\"x_value\", \"v_value\"),\n        names_to = \"series\",\n        values_to = \"value\"\n    )\n\nggplot(data, aes(\n    x = time,\n    y = value,\n    color = series,\n    linetype = series\n)) +\n    geom_line() +\n    facet_wrap(~ type, ncol = 1) +\n    labs(y = \"Value\", x = \"Time\", title = \"Time Series and Moving Averages\") +\n    scale_color_manual(\n        values = c(\"x_value\" = \"blue\", \"v_value\" = \"red\"),\n        breaks = c(\"x_value\", \"v_value\")\n    ) +\n    scale_linetype_manual(\n        values = c(\"x_value\" = \"solid\", \"v_value\" = \"dashed\"),\n        breaks = c(\"x_value\", \"v_value\")\n    ) +\n    theme_minimal()\n```\n\n(d)\n\n移动平均后都变得更为平缓。\n\n# 1.3小节\n\n## 1.4\n\n$$\n\\begin{aligned}\n\\gamma(s,t)&=\\operatorname{cov}(x_t,x_t)=\\operatorname{E}[(x_s-\\mu_s)(x_t-\\mu_t)]\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_t\\operatorname{E}(x_s)-\\mu_s\\operatorname{E}(x_t)+\\mu_s\\mu_t\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_t\\mu_s-\\mu_s\\mu_t+\\mu_s\\mu_t\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_s\\mu_t\n\\end{aligned}\n$$\n\n## 1.5\n\n(a)\n\n$$\n\\mu_{x}=\\operatorname{E}(s_t+w_t)=s_t\n$$\n\n```{r}\n# a\nset.seed(44)\ns_a <- c(rep(0, 100), 10 * exp(-(101:200 - 100) / 20) * cos(2 * pi * 101:200 / 4))\ndata_a <- tibble(time = 1:200, s_a = s_a)\np_15a <- ggplot(data_a, aes(x = time, y = s_a)) +\n    geom_line() +\n    theme_minimal()\n\n# b\nset.seed(44)\ns_b = c(rep(0, 100), 10 * exp(-(101:200 - 100) / 200) * cos(2 * pi * 101:200 / 4))\ndata_a <- tibble(time = 1:200, s_b = s_b)\np_15b <- ggplot(data_a, aes(x = time, y = s_b)) +\n    geom_line() +\n    theme_minimal()\n\nplot_grid(p_15a, p_15b, ncol = 1)\n```\n\n(b)\n\n$$\n\\begin{aligned}\n\\gamma_x(s,t)&=\\operatorname{cov}(x_s,x_t)=\\operatorname{E}[(x_s-\\mu_s)(x_t-\\mu_t)]\\\\\n&=\\operatorname{E}[(x_s-s_s)(x_t-s_t)]\\\\\n&=\\operatorname{E}(w_sw_t)\n\\end{aligned}\n$$\n\n所以有：\n\n$$\n\\gamma_x(s,t)=\n\\begin{cases}\n\\sigma^2_w=1&s=t\\\\\n0&s\\neq t\n\\end{cases}\n$$\n\n# 1.4小节\n\n## 1.6\n\n(a)\n\n**平均函数**：\n\n$$\n\\operatorname{E}(x_t)=\\operatorname{E}(\\beta_1+\\beta_2t)=\\beta_1+\\beta_2t\n$$\n\n不是常数，故不是平稳的。\n\n(b)\n\n$$\ny_t=x_t-x_{t-1}=\\beta_2+w_t-w_{t-1}\n$$\n\n**平均函数**：\n\n$$\n\\operatorname{E}(y_t)=\\operatorname{E}(\\beta_2+w_t-w_{t-1})=\\beta_2\n$$\n\n**自协方差函数**：\n\n$$\n\\begin{aligned}\n\\gamma_y(h)&=\\operatorname{cov}(y_{t+h},y_t)=\\operatorname{cov}(\\beta_2+w_{t+h}-w_{t+h-1},\\beta_2+w_t-w_{t-1})\\\\\n&=\\operatorname{cov}(w_{t+h},w_t)-\\operatorname{cov}(w_{t+h},w_{t-1})-\\operatorname{cov}(w_{t+h-1},w_t)+\\operatorname{cov}(w_{t+h-1},w_{t-1})\n\\end{aligned}\n$$\n\n显然与$t$无关，结果为：\n\n$$\n\\gamma_y(h)=\\begin{cases}\n2&h=0\\\\\n-1&h=\\pm1\\\\\n0&|h|\\ge2\n\\end{cases}\n$$\n\n所以$y_t$是平稳的。\n\n(c)\n\n**平均函数**：\n\n$$\n\\begin{aligned}\n\\operatorname{E}(v_t)&=\\frac{1}{2q+1}\\sum_{j=-q}^{q}(\\beta_1+\\beta_2t-\\beta_2j)\\\\\n&=\\frac{1}{2q+1}[(2q+1)(\\beta_1+\\beta_2t)-\\beta_2\\sum_{j=-q}^{q}j]\\\\\n&=\\beta_1+\\beta_2t\n\\end{aligned}\n$$\n\n**自协方差函数**：\n\n先对$v_t$进行分解。\n\n$$\n\\begin{aligned}\nv_t&=\\frac{1}{2q+1}\\sum_{j=-q}^{q}(\\beta_1+\\beta_2t-\\beta_2j+w_{t-j})\\\\\n&=\\frac{1}{2q+1}[(2q+1)\\beta_1+(2q+1)\\beta_2t+\\sum_{j=-q}^{q}w_{t-j}]\\\\\n&=\\beta_1+\\beta_2t+\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t-j}\n\\end{aligned}\n$$\n\n$$\n\\begin{aligned}\n\\gamma_v(h)&=\\operatorname{cov}(v_{t+h},v_t)\\\\\n&=\\operatorname{cov}(\\beta_1+\\beta_2(t+h)+\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t+h-j},\\beta_1+\\beta_2t+\\frac{1}{2q+1}\\sum_{k=-q}^{q}w_{t-k})\\\\\n&=\\operatorname{cov}(\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t+h-j},\\frac{1}{2q+1}\\sum_{k=-q}^{q}w_{t-k})\\\\\n&=\\frac{1}{(2q+1)^2}\\sum_{j=-q}^{q}\\sum_{k=-q}^{q}\\operatorname{cov}(w_{t+h-j},w_{t-k})\n\\end{aligned}\n$$\n\n需要在$\\sum_{j=-q}^{q}$和$\\sum_{k=-q}^{q}$中取更小的那个，所以：\n\n$$\n\\gamma_v(h)=\\begin{cases}\n\\frac{1}{(2q+1)^2}(2q+1-|h|)\\sigma_w^2&h=j-k\\\\\n0&h\\neq j-k\n\\end{cases}\n$$\n\n因为$j$和$k$的取值范围都是$[-q,q]$，所以$|h|\\le 2q$。\n\n## 1.7{#sec-1_7}\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma_x(h)&=\\operatorname{cov}(x_s.x_t)=\\operatorname{cov}(x_{t+h},x_t)\\\\\n&=\\operatorname{cov}(w_{t+h-1}+2w_{t+h}+w_{t+h+1},w_{t-1}+2w_t+w_{t+1})\\\\\n&\\begin{aligned}=\n&\\operatorname{cov}(w_{t+h-1},w_{t-1})+2\\operatorname{cov}(w_{t+h-1},w_t)+\\operatorname{cov}(w_{t+h-1},w_{t+1})+\\\\\n&2\\operatorname{cov}(w_{t+h},w_{t-1})+4\\operatorname{cov}(w_{t+h},w_t)+2\\operatorname{cov}(w_{t+h},w_{t+1})+\\\\\n&\\operatorname{cov}(w_{t+h+1},w_{t-1})+2\\operatorname{cov}(w_{t+h+1},w_t)+\\operatorname{cov}(w_{t+h+1},w_{t+1})\n\\end{aligned}\n\\end{aligned}\n$$\n\n所以：\n\n$$\n\\gamma_x(h)=\\begin{cases}\n6\\sigma_w^2&h=0\\\\\n4\\sigma_w^2&|h|=1\\\\\n\\sigma_w^2&|h|=2\\\\\n0&|h|\\ge3\n\\end{cases}\n$$\n\n**自相关函数**\n\n$$\n\\rho_x(h)=\\frac{\\gamma_x(h)}{\\gamma_x(0)}=\\begin{cases}\n1&h=0\\\\\n\\frac{2}{3}&|h|=1\\\\\n\\frac{1}{6}&|h|=2\\\\\n0&|h|\\ge3\n\\end{cases}\n$$\n\n```{r, results='hide'}\nset.seed(44)\nw_17 <- rnorm(1050)\nx_17 <- stats::filter(w_17,\n                      method = \"convolution\",\n                      filter = c(1, 2, 1),\n                      sides = 2)[-(1:50)]\nacf1(x_17, max.lag = 5, gg = T)\n```\n\n## 1.8\n\n(a)\n\n$$\n\\begin{aligned}\nx_t&=\\delta+x_{t-1}+w_t\\\\\n&=\\delta+(\\delta+x_{t-2}+w_{t-1})+w_t\\\\\n&=\\delta j+w_{t-j}+\\sum_{k=t-j+1}^tw_k\\\\\n&=\\delta t+\\sum_{k=1}^tw_k\n\\end{aligned}\n$$\n\n(b)\n\n**均值函数**\n\n$$\n\\begin{aligned}\n\\operatorname{E}x_t=\\operatorname{E}(\\delta t+\\sum_{k=1}^tw_k)=\\delta t\n\\end{aligned}\n$$\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma_x(s,t)&=\\operatorname{cov}(x_s,x_t)=\\operatorname{E}\\{(x_s-\\mu_s)(x_t-\\mu_t)\\}\\\\\n&=\\operatorname{E}(\\sum_{j=1}^sw_j\\sum_{k=1}^tw_k)\\\\\n&=\\operatorname{min}(s,t)\\sigma_w^2\n\\end{aligned}\n$$\n\n(c)\n\n均值函数和自协方差函数都随$t$变化，所以不平稳。\n\n(d)\n\n$$\n\\rho_x(t-1,t)=\\frac{(t-1)\\sigma_w^2}{\\sqrt{(t-1)\\sigma_w^2}\\sqrt{t\\sigma_w^2}}=\\sqrt{\\frac{t-1}{t}}\n$$\n\n当$t\\to\\infty$，$\\rho_x(t-1,t)\\to0$，说明该时间序列变化逐渐变缓，$x_t$近似于$x_{t-1}$。\n\n(e)\n\n$$\n\\nabla x_t=x_t-x_{t-1}=\\delta+w_t\n$$\n\n均值函数$\\mu_{x,t}=\\delta$，自相关函数$\\gamma_x(h)=\\sigma_w^2\\delta_0(h)$，均和$t$无关。\n\n:::{.callout-tip}\n$\\delta_0(h)$表示当$h=0$时，$\\delta_0(h)=1$；当$h\\neq0$时，$\\delta_0(h)=0$。\n:::\n\n## 1.9\n\n**均值函数**\n\n$$\n\\because \\operatorname{E}(U_1)=\\operatorname{E}(U_2)=0\\\\\n\\therefore \\operatorname{E}(x_t)=\\sin(2\\pi w_0t)\\operatorname{E}(U_1)+\\cos(2\\pi w_0t)\\operatorname{E}(U_2)=0\n$$\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma(h)&=\\operatorname{E}(x_{t+h}x_t)\\\\\n&=\\operatorname{E}\\{(U_1\\sin[2\\pi w_0(t+h)]+U_2\\cos[2\\pi w_0(t+h)])(U_1\\sin[2\\pi w_0t]+U_2\\cos[2\\pi w_0t])\\}\\\\\n&=\\sigma^2(\\sin[2\\pi w_0(t+h)]\\sin[2\\pi w_0t]+\\cos[2\\pi w_0(t+h)]\\cos[2\\pi w_0t])\\\\\n&=\\sigma^2\\cos[2\\pi w_0(t+h)-2\\pi w_0t]\\\\\n&=\\sigma^2\\cos(2\\pi w_0h)\n\\end{aligned}\n$$\n\n均值函数和自协方差函数与$t$无关，为弱平稳序列。\n\n## 1.10\n\n(a)\n\n$$\n\\begin{aligned}\n\\operatorname{MSE}(A)&=\\operatorname{E}[(x_{t+\\ell}-Ax_t)^2]=\\operatorname{E}[x_{t+\\ell}^2+A^2x_t^2-2Ax_{t+\\ell}x_t]\\\\\n&=\\gamma(0)+A^2\\gamma(0)-2A\\gamma(\\ell)\\\\\n&=\\gamma(0)(A^2-2A\\rho(\\ell)+1)\\\\\n&=\\gamma(0)([A-\\rho(\\ell)]^2-\\rho^2(\\ell)+1)\n\\end{aligned}\n$$\n\n在$A=\\rho(\\ell)$取最小值。\n\n(b)\n\n当$A=\\rho(\\ell)$时，有：\n\n$$\n\\begin{aligned}\n\\operatorname{MSE}(A)&=\\operatorname{E}[(x_{t+\\ell}-Ax_t)^2]=\\operatorname{E}[x_{t+\\ell}^2+A^2x_t^2-2Ax_{t+\\ell}x_t]\\\\\n&=\\gamma(0)+A^2\\gamma(0)-2A\\gamma(\\ell)\\\\\n&=\\gamma(0)[1+\\rho^2(\\ell)-2\\rho^2(\\ell)]\\\\\n&=\\gamma(0)[1-\\rho^2(\\ell)]\n\\end{aligned}\n$$\n\n(c)\n\n如果$x_{x+\\ell}=Ax_t$，则$\\operatorname{MSE}(A)=0$恒成立，一定有$\\gamma(0)[1-\\rho^2(\\ell)]=0$，所以$\\rho(\\ell)=\\pm1$。成立。\n\n## 1.11\n\n(a)\n\n$$\n\\begin{aligned}\n\\gamma(h)&=\\operatorname{cov}(\\sum_k\\psi_kw_{t+h-k},\\sum_j\\psi_jw_{t-j})\\\\\n&=\\operatorname{E}(\\sum_{k=-\\infty}^\\infty\\sum_{j=-\\infty}^\\infty\\psi_k\\psi_jw_{t+h-k}w_{t-j})\\\\\n&=\\sigma_w^2\\sum_{j,k}\\psi_k\\psi_j\\delta_{h-k+j}\\\\\n&=\\sigma_w^2\\sum_{k=-\\infty}^\\infty\\psi_{k+h}\\psi_k\n\\end{aligned}\n$$\n\n:::{.callout-tip}\n对[@sec-1_7]解法进行优化。\n\n$$\n\\begin{aligned}\n\\gamma_x(h)&=\\operatorname{cov}(\\sum_{k=-1}^1\\psi_kw_{t+h-k},\\sum_{j=-1}^1\\psi_jw_{t-j})\\\\\n&=\\sigma_w^2\\sum_{k=-1}^1\\sum_{j=-1}^1\\psi_k\\psi_j\\delta_{h-k+j}\n\\end{aligned}\n$$\n:::\n\n(b)\n\n见原书附录。\n\n## 1.12\n\n$$\n\\gamma_{xy}(h)=\\operatorname{E}[(x_{t+h}-\\mu_x)(y_t-\\mu_y)]=\\operatorname{E}[(y_t-\\mu_y)(x_{t+h}-\\mu_x)]=\\gamma_{yx}(-h)\n$$\n\n## 1.13\n\n(a)\n\n$$\n\\begin{aligned}\n\\gamma_y(h)&=\\operatorname{cov}(w_{t+h}-\\theta w_{t+h-1}+u_{t+h},w_t-\\theta w_{t-1}+u_t)\\\\\n&=\\operatorname{cov}(w_{t+h},w_t)-\\theta\\operatorname{cov}(w_{t+h},w_{t-1})-\\theta\\operatorname{cov}(w_{t+h-1},w_t)+\\theta^2cov(w_{t+h-1},w_{t-1})+\\operatorname{cov}(u_{t+h},u_t)\n\\end{aligned}\n$$\n\n所以\n\n$$\n\\gamma_y(h)=\\begin{cases}\n\\sigma_w^2(1+\\theta^2)+\\sigma_u^2&h=0\\\\\n-\\theta\\sigma_w^2&h=\\pm1\\\\\n0&|h|\\ge2\n\\end{cases}\n$$\n\n所以\n\n$$\n\\rho_y(h)=\\begin{cases}\n1&h=0\\\\\n\\frac{-\\theta\\sigma_w^2}{\\sigma_w^2(1+\\theta^2)+\\sigma_u^2}&h=\\pm1\\\\\n0&|h|\\ge2\n\\end{cases}\n$$\n\n(b)\n\n易得\n\n$$\n\\gamma_x(h)=\\begin{cases}\n\\sigma_w^2&h=0\\\\\n0&h\\neq0\n\\end{cases}\n$$\n\n和\n\n$$\n\\gamma_{xy}(h)=\\operatorname{cov}(w_{t+h},w_t-\\theta w_{t-1}+u_t)=\\begin{cases}\n\\sigma_w^2&h=0\\\\\n-\\theta\\sigma_w^2&h=-1\\\\\n0&\\operatorname{otherwise}\n\\end{cases}\n$$\n\n所以\n\n$$\n\\rho_{xy}(h)=\\frac{\\gamma_{xy}(h)}{\\sqrt{\\gamma_x(0)\\gamma_y(0)}}=\\begin{cases}\n\\frac{\\sigma_w^2}{\\sigma_w^2(2+\\theta^2)+\\sigma_u^2}&h=0\\\\\n\\frac{-\\theta\\sigma_w^2}{\\sigma_w^2(1+\\theta^2)+\\sigma_u^2}&h=-1\\\\\n0&\\operatorname{otherwise}\n\\end{cases}\n$$\n\n(c)\n\n自协方差和交叉协方差都只和$h$有关，所以联合平稳。\n\n## 1.14\n\n(a)\n\n$\\lambda=1$代入：\n\n$$\n\\operatorname{E}(y_t)=\\operatorname{E}[\\exp\\{x_t\\}]=\\exp\\{\\mu_x+\\frac{1}{2}\\gamma(0)\\}\n$$\n\n(b)\n\n$$\n\\gamma_y(h)=\\operatorname{cov}(y_{t+h},y_t)=\\operatorname{E}(y_{t+h}y_t)-\\operatorname{E}(y_{t+h})\\operatorname{E}(y_{t})\n$$\n\n分解一下：\n\n$$\n\\begin{aligned}\n\\operatorname{E}(y_{t+h}y_t)&=\\operatorname{E}[\\exp(x_{t+h})\\exp(x_t)]=\\operatorname{E}[\\exp(x_{t+h}+x_t)]\\\\\n&=\\exp\\{\\operatorname{E}(x_{t+h}+x_t)+\\frac{1}{2}\\operatorname{var}(x_{t+h}+x_t)\\}\n\\end{aligned}\n$$\n\n其中：\n\n$$\n\\operatorname{E}(x_{t+h}+x_t)=2\\mu_x\\\\\n\\operatorname{var}(x_{t+h}+x_t)=\\operatorname{var}(x_{t+h})+\\operatorname{var}(x_t)+2\\operatorname{cov}(x_{t+h},x_t)=2\\gamma(0)+2\\gamma(h)\n$$\n\n所以\n\n$$\n\\operatorname{E}(y_{t+h}y_t)=\\exp\\{2\\mu_x+\\gamma(0)+\\gamma(h)\\}\n$$\n\n所以\n\n$$\n\\begin{aligned}\n\\gamma_y(h)&=\\exp\\{2\\mu_x+\\gamma(0)+\\gamma(h)\\}-(\\exp\\{\\mu_x+\\frac{1}{2}\\gamma(0)\\})^2\\\\\n&=\\exp\\{2\\mu_x+\\gamma(0)+\\gamma(h)\\}-\\exp\\{2\\mu_x+\\gamma(0)\\}\\\\\n&=\\exp\\{2\\mu_x+\\gamma(0)\\}(\\exp\\{\\gamma(h)\\}-1)\n\\end{aligned}\n$$\n\n## 1.15\n\n**均值函数**\n\n$$\n\\mu_t=\\operatorname{E}(w_tw_{t-1})=\\operatorname{E}(w_t)\\operatorname{E}(w_{t-1})=0\n$$\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma_x(h)&=\\operatorname{cov}(w_{t+h}w_{t+h-1},w_tw_{t-1})\\\\\n&=\\operatorname{E}(w_{t+h}w_{t+h-1}w_tw_{t-1})\n\\end{aligned}\n$$\n\n所以\n\n$$\n\\gamma_x(h)=\\begin{cases}\n\\sigma_w^4&h=0\\\\\n\\sigma_w^2&|h|=1\\\\\n0&|h|\\ge2\n\\end{cases}\n$$\n\n均和$t$无关，平稳。\n\n## 1.16\n\n(a)\n\n**均值函数**\n\n$$\n\\begin{aligned}\n\\operatorname{E}(x_t)=\\int_0^1\\sin(2\\pi ut)\\mathrm{d}u=-\\frac{1}{2\\pi t}\\cos(2\\pi ut)\\Bigg|_0^1=-\\frac{1}{2\\pi t}[\\cos(2\\pi t)-1]=0\n\\end{aligned}\n$$\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma(h)&=\\int_0^1\\sin[2\\pi u(t+h)]\\sin[2\\pi ut]\\mathrm{d}u\\\\\n&=\\frac{1}{2}\\int_0^1\\cos(2\\pi uh)\\mathrm{d}u-\\frac{1}{2}\\int_0^1\\cos(2\\pi u(2t + h))\\mathrm{d}u\n\\end{aligned}\n$$\n\n当$h=0$时，$\\gamma(h)=\\frac{1}{2}$\n\n当$h\\neq0$时\n\n$$\n\\gamma(h)=\\frac{1}{2}\\left[\\frac{\\sin(2\\pi h)}{2\\pi h}-\\frac{\\sin(2\\pi (2t+h))}{2\\pi (2t+h)}\\right]=0\n$$\n\n综上，为弱平稳。\n\n(b)\n\n$t=1$、$t=2$、$t=3$代入，$x_1$和$x_2$，$x_2$和$x_3$关系不一样，所以非严平稳。\n\n","srcMarkdownNoYaml":"\n\n主要参考书籍为Shumway和Stoffer[-@Shumway_2017]的Time Series Analysis and Its Applications: With R Examples。\n\n该书第五版正在制作，配套`astsa`包中的部分数据集会逐渐更新，所以后期也许会换成第五版内容。\n\n该内容为第一章的习题答案，基于个人习惯，使用的大多数是`tidyverse`系列代码，会和之前学习笔记中的代码习惯有所不同。\n\n::: callout-tip\n提示框表明这部分完全是个人理解，可能有误。\n\n一切错误和想讨论的内容欢迎联系邮箱(zhoubolin0404@126.com)，感谢！\n:::\n\n```{r,warning=FALSE,message=FALSE}\nlibrary(tidyverse)\nlibrary(astsa)\nlibrary(cowplot)\n```\n\n\n# 1.1小节\n\n## 1.1\n\n```{r}\ndata <- data.frame(\n    time = 1:length(EQ5),\n    Earthquake = EQ5,\n    Explosion = EXP6\n) %>%\n    pivot_longer(\n        cols = c(\"Earthquake\", \"Explosion\"),\n        names_to = \"type\",\n        values_to = \"value\"\n    )\n\nggplot(data, aes(x = time, y = value, color = type)) +\n    geom_line() +\n    labs(y = \"Amplitude\", x = \"Time\", title = \"Earthquake vs Explosion Signals\") +\n    scale_color_manual(values = c(\"black\", \"red\")) +\n    theme_minimal() +\n    theme(legend.position = \"top\") +\n    guides(color = guide_legend(title = NULL, override.aes = list(linetype = 1)))\n```\n\n爆炸信号消失得更快，早期振幅更大。\n\n## 1.2\n\n(a)和(c)\n\n```{r}\nset.seed(44)\ns_a <- c(rep(0, 100), 10 * exp(-(101:200 - 100) / 20) * cos(2 * pi * 101:200 / 4))\nx_a = s_a + rnorm(200)\ndecay_line_a = c(rep(0, 100), 10 * exp(-(1:100) / 20))\ndata_a <- as_tibble(x_a) %>%\n    mutate(time = 1:200, decay_line = decay_line_a)\nggplot(data_a, aes(x = time)) +\n    geom_line(aes(y = value), color = \"black\") +\n    geom_line(aes(y = decay_line), color = \"red\") +\n    theme_minimal()\n```\n\n(b)和(c)\n\n```{r}\nset.seed(44)\ns_b = c(rep(0, 100), 10 * exp(-(101:200 - 100) / 200) * cos(2 * pi * 101:200 / 4))\nx_b = s_b + rnorm(200)\ndecay_line_b = c(rep(0, 100), 10 * exp(-(1:100) / 200))\ndata_b <- as_tibble(x_b) %>%\n    mutate(time = 1:200, decay_line = decay_line_b)\nggplot(data_b, aes(x = time)) +\n    geom_line(aes(y = value), color = \"black\") +\n    geom_line(aes(y = decay_line), color = \"red\") +\n    theme_minimal()\n```\n\n# 1.2小节\n\n## 1.3\n\n(a)-(c)\n\n```{r,warning=FALSE}\nset.seed(44)\nw = rnorm(150, 0, 1)\nx = stats::filter(w, filter = c(0, -0.9), method = \"recursive\")[-(1:50)]\nx2 = 2 * cos(2 * pi * (1:100) / 4)\nx3 = x2 + rnorm(100, 0, 1)\n\nv = stats::filter(x, rep(1, 4) / 4, sides = 1)\nv2 = stats::filter(x2, rep(1, 4) / 4, sides = 1)\nv3 = stats::filter(x3, rep(1, 4) / 4, sides = 1)\n\ndata <- tibble(\n    time = rep(1:100, 3),\n    x_value = c(x, x2, x3),\n    v_value = c(v, v2, v3),\n    type = rep(c(\n        \"autoregression\", \"sinusoid\", \"sinusoid + noise\"\n    ), each = 100)\n) %>%\n    pivot_longer(\n        cols = c(\"x_value\", \"v_value\"),\n        names_to = \"series\",\n        values_to = \"value\"\n    )\n\nggplot(data, aes(\n    x = time,\n    y = value,\n    color = series,\n    linetype = series\n)) +\n    geom_line() +\n    facet_wrap(~ type, ncol = 1) +\n    labs(y = \"Value\", x = \"Time\", title = \"Time Series and Moving Averages\") +\n    scale_color_manual(\n        values = c(\"x_value\" = \"blue\", \"v_value\" = \"red\"),\n        breaks = c(\"x_value\", \"v_value\")\n    ) +\n    scale_linetype_manual(\n        values = c(\"x_value\" = \"solid\", \"v_value\" = \"dashed\"),\n        breaks = c(\"x_value\", \"v_value\")\n    ) +\n    theme_minimal()\n```\n\n(d)\n\n移动平均后都变得更为平缓。\n\n# 1.3小节\n\n## 1.4\n\n$$\n\\begin{aligned}\n\\gamma(s,t)&=\\operatorname{cov}(x_t,x_t)=\\operatorname{E}[(x_s-\\mu_s)(x_t-\\mu_t)]\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_t\\operatorname{E}(x_s)-\\mu_s\\operatorname{E}(x_t)+\\mu_s\\mu_t\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_t\\mu_s-\\mu_s\\mu_t+\\mu_s\\mu_t\\\\\n&=\\operatorname{E}(x_sx_t)-\\mu_s\\mu_t\n\\end{aligned}\n$$\n\n## 1.5\n\n(a)\n\n$$\n\\mu_{x}=\\operatorname{E}(s_t+w_t)=s_t\n$$\n\n```{r}\n# a\nset.seed(44)\ns_a <- c(rep(0, 100), 10 * exp(-(101:200 - 100) / 20) * cos(2 * pi * 101:200 / 4))\ndata_a <- tibble(time = 1:200, s_a = s_a)\np_15a <- ggplot(data_a, aes(x = time, y = s_a)) +\n    geom_line() +\n    theme_minimal()\n\n# b\nset.seed(44)\ns_b = c(rep(0, 100), 10 * exp(-(101:200 - 100) / 200) * cos(2 * pi * 101:200 / 4))\ndata_a <- tibble(time = 1:200, s_b = s_b)\np_15b <- ggplot(data_a, aes(x = time, y = s_b)) +\n    geom_line() +\n    theme_minimal()\n\nplot_grid(p_15a, p_15b, ncol = 1)\n```\n\n(b)\n\n$$\n\\begin{aligned}\n\\gamma_x(s,t)&=\\operatorname{cov}(x_s,x_t)=\\operatorname{E}[(x_s-\\mu_s)(x_t-\\mu_t)]\\\\\n&=\\operatorname{E}[(x_s-s_s)(x_t-s_t)]\\\\\n&=\\operatorname{E}(w_sw_t)\n\\end{aligned}\n$$\n\n所以有：\n\n$$\n\\gamma_x(s,t)=\n\\begin{cases}\n\\sigma^2_w=1&s=t\\\\\n0&s\\neq t\n\\end{cases}\n$$\n\n# 1.4小节\n\n## 1.6\n\n(a)\n\n**平均函数**：\n\n$$\n\\operatorname{E}(x_t)=\\operatorname{E}(\\beta_1+\\beta_2t)=\\beta_1+\\beta_2t\n$$\n\n不是常数，故不是平稳的。\n\n(b)\n\n$$\ny_t=x_t-x_{t-1}=\\beta_2+w_t-w_{t-1}\n$$\n\n**平均函数**：\n\n$$\n\\operatorname{E}(y_t)=\\operatorname{E}(\\beta_2+w_t-w_{t-1})=\\beta_2\n$$\n\n**自协方差函数**：\n\n$$\n\\begin{aligned}\n\\gamma_y(h)&=\\operatorname{cov}(y_{t+h},y_t)=\\operatorname{cov}(\\beta_2+w_{t+h}-w_{t+h-1},\\beta_2+w_t-w_{t-1})\\\\\n&=\\operatorname{cov}(w_{t+h},w_t)-\\operatorname{cov}(w_{t+h},w_{t-1})-\\operatorname{cov}(w_{t+h-1},w_t)+\\operatorname{cov}(w_{t+h-1},w_{t-1})\n\\end{aligned}\n$$\n\n显然与$t$无关，结果为：\n\n$$\n\\gamma_y(h)=\\begin{cases}\n2&h=0\\\\\n-1&h=\\pm1\\\\\n0&|h|\\ge2\n\\end{cases}\n$$\n\n所以$y_t$是平稳的。\n\n(c)\n\n**平均函数**：\n\n$$\n\\begin{aligned}\n\\operatorname{E}(v_t)&=\\frac{1}{2q+1}\\sum_{j=-q}^{q}(\\beta_1+\\beta_2t-\\beta_2j)\\\\\n&=\\frac{1}{2q+1}[(2q+1)(\\beta_1+\\beta_2t)-\\beta_2\\sum_{j=-q}^{q}j]\\\\\n&=\\beta_1+\\beta_2t\n\\end{aligned}\n$$\n\n**自协方差函数**：\n\n先对$v_t$进行分解。\n\n$$\n\\begin{aligned}\nv_t&=\\frac{1}{2q+1}\\sum_{j=-q}^{q}(\\beta_1+\\beta_2t-\\beta_2j+w_{t-j})\\\\\n&=\\frac{1}{2q+1}[(2q+1)\\beta_1+(2q+1)\\beta_2t+\\sum_{j=-q}^{q}w_{t-j}]\\\\\n&=\\beta_1+\\beta_2t+\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t-j}\n\\end{aligned}\n$$\n\n$$\n\\begin{aligned}\n\\gamma_v(h)&=\\operatorname{cov}(v_{t+h},v_t)\\\\\n&=\\operatorname{cov}(\\beta_1+\\beta_2(t+h)+\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t+h-j},\\beta_1+\\beta_2t+\\frac{1}{2q+1}\\sum_{k=-q}^{q}w_{t-k})\\\\\n&=\\operatorname{cov}(\\frac{1}{2q+1}\\sum_{j=-q}^{q}w_{t+h-j},\\frac{1}{2q+1}\\sum_{k=-q}^{q}w_{t-k})\\\\\n&=\\frac{1}{(2q+1)^2}\\sum_{j=-q}^{q}\\sum_{k=-q}^{q}\\operatorname{cov}(w_{t+h-j},w_{t-k})\n\\end{aligned}\n$$\n\n需要在$\\sum_{j=-q}^{q}$和$\\sum_{k=-q}^{q}$中取更小的那个，所以：\n\n$$\n\\gamma_v(h)=\\begin{cases}\n\\frac{1}{(2q+1)^2}(2q+1-|h|)\\sigma_w^2&h=j-k\\\\\n0&h\\neq j-k\n\\end{cases}\n$$\n\n因为$j$和$k$的取值范围都是$[-q,q]$，所以$|h|\\le 2q$。\n\n## 1.7{#sec-1_7}\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma_x(h)&=\\operatorname{cov}(x_s.x_t)=\\operatorname{cov}(x_{t+h},x_t)\\\\\n&=\\operatorname{cov}(w_{t+h-1}+2w_{t+h}+w_{t+h+1},w_{t-1}+2w_t+w_{t+1})\\\\\n&\\begin{aligned}=\n&\\operatorname{cov}(w_{t+h-1},w_{t-1})+2\\operatorname{cov}(w_{t+h-1},w_t)+\\operatorname{cov}(w_{t+h-1},w_{t+1})+\\\\\n&2\\operatorname{cov}(w_{t+h},w_{t-1})+4\\operatorname{cov}(w_{t+h},w_t)+2\\operatorname{cov}(w_{t+h},w_{t+1})+\\\\\n&\\operatorname{cov}(w_{t+h+1},w_{t-1})+2\\operatorname{cov}(w_{t+h+1},w_t)+\\operatorname{cov}(w_{t+h+1},w_{t+1})\n\\end{aligned}\n\\end{aligned}\n$$\n\n所以：\n\n$$\n\\gamma_x(h)=\\begin{cases}\n6\\sigma_w^2&h=0\\\\\n4\\sigma_w^2&|h|=1\\\\\n\\sigma_w^2&|h|=2\\\\\n0&|h|\\ge3\n\\end{cases}\n$$\n\n**自相关函数**\n\n$$\n\\rho_x(h)=\\frac{\\gamma_x(h)}{\\gamma_x(0)}=\\begin{cases}\n1&h=0\\\\\n\\frac{2}{3}&|h|=1\\\\\n\\frac{1}{6}&|h|=2\\\\\n0&|h|\\ge3\n\\end{cases}\n$$\n\n```{r, results='hide'}\nset.seed(44)\nw_17 <- rnorm(1050)\nx_17 <- stats::filter(w_17,\n                      method = \"convolution\",\n                      filter = c(1, 2, 1),\n                      sides = 2)[-(1:50)]\nacf1(x_17, max.lag = 5, gg = T)\n```\n\n## 1.8\n\n(a)\n\n$$\n\\begin{aligned}\nx_t&=\\delta+x_{t-1}+w_t\\\\\n&=\\delta+(\\delta+x_{t-2}+w_{t-1})+w_t\\\\\n&=\\delta j+w_{t-j}+\\sum_{k=t-j+1}^tw_k\\\\\n&=\\delta t+\\sum_{k=1}^tw_k\n\\end{aligned}\n$$\n\n(b)\n\n**均值函数**\n\n$$\n\\begin{aligned}\n\\operatorname{E}x_t=\\operatorname{E}(\\delta t+\\sum_{k=1}^tw_k)=\\delta t\n\\end{aligned}\n$$\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma_x(s,t)&=\\operatorname{cov}(x_s,x_t)=\\operatorname{E}\\{(x_s-\\mu_s)(x_t-\\mu_t)\\}\\\\\n&=\\operatorname{E}(\\sum_{j=1}^sw_j\\sum_{k=1}^tw_k)\\\\\n&=\\operatorname{min}(s,t)\\sigma_w^2\n\\end{aligned}\n$$\n\n(c)\n\n均值函数和自协方差函数都随$t$变化，所以不平稳。\n\n(d)\n\n$$\n\\rho_x(t-1,t)=\\frac{(t-1)\\sigma_w^2}{\\sqrt{(t-1)\\sigma_w^2}\\sqrt{t\\sigma_w^2}}=\\sqrt{\\frac{t-1}{t}}\n$$\n\n当$t\\to\\infty$，$\\rho_x(t-1,t)\\to0$，说明该时间序列变化逐渐变缓，$x_t$近似于$x_{t-1}$。\n\n(e)\n\n$$\n\\nabla x_t=x_t-x_{t-1}=\\delta+w_t\n$$\n\n均值函数$\\mu_{x,t}=\\delta$，自相关函数$\\gamma_x(h)=\\sigma_w^2\\delta_0(h)$，均和$t$无关。\n\n:::{.callout-tip}\n$\\delta_0(h)$表示当$h=0$时，$\\delta_0(h)=1$；当$h\\neq0$时，$\\delta_0(h)=0$。\n:::\n\n## 1.9\n\n**均值函数**\n\n$$\n\\because \\operatorname{E}(U_1)=\\operatorname{E}(U_2)=0\\\\\n\\therefore \\operatorname{E}(x_t)=\\sin(2\\pi w_0t)\\operatorname{E}(U_1)+\\cos(2\\pi w_0t)\\operatorname{E}(U_2)=0\n$$\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma(h)&=\\operatorname{E}(x_{t+h}x_t)\\\\\n&=\\operatorname{E}\\{(U_1\\sin[2\\pi w_0(t+h)]+U_2\\cos[2\\pi w_0(t+h)])(U_1\\sin[2\\pi w_0t]+U_2\\cos[2\\pi w_0t])\\}\\\\\n&=\\sigma^2(\\sin[2\\pi w_0(t+h)]\\sin[2\\pi w_0t]+\\cos[2\\pi w_0(t+h)]\\cos[2\\pi w_0t])\\\\\n&=\\sigma^2\\cos[2\\pi w_0(t+h)-2\\pi w_0t]\\\\\n&=\\sigma^2\\cos(2\\pi w_0h)\n\\end{aligned}\n$$\n\n均值函数和自协方差函数与$t$无关，为弱平稳序列。\n\n## 1.10\n\n(a)\n\n$$\n\\begin{aligned}\n\\operatorname{MSE}(A)&=\\operatorname{E}[(x_{t+\\ell}-Ax_t)^2]=\\operatorname{E}[x_{t+\\ell}^2+A^2x_t^2-2Ax_{t+\\ell}x_t]\\\\\n&=\\gamma(0)+A^2\\gamma(0)-2A\\gamma(\\ell)\\\\\n&=\\gamma(0)(A^2-2A\\rho(\\ell)+1)\\\\\n&=\\gamma(0)([A-\\rho(\\ell)]^2-\\rho^2(\\ell)+1)\n\\end{aligned}\n$$\n\n在$A=\\rho(\\ell)$取最小值。\n\n(b)\n\n当$A=\\rho(\\ell)$时，有：\n\n$$\n\\begin{aligned}\n\\operatorname{MSE}(A)&=\\operatorname{E}[(x_{t+\\ell}-Ax_t)^2]=\\operatorname{E}[x_{t+\\ell}^2+A^2x_t^2-2Ax_{t+\\ell}x_t]\\\\\n&=\\gamma(0)+A^2\\gamma(0)-2A\\gamma(\\ell)\\\\\n&=\\gamma(0)[1+\\rho^2(\\ell)-2\\rho^2(\\ell)]\\\\\n&=\\gamma(0)[1-\\rho^2(\\ell)]\n\\end{aligned}\n$$\n\n(c)\n\n如果$x_{x+\\ell}=Ax_t$，则$\\operatorname{MSE}(A)=0$恒成立，一定有$\\gamma(0)[1-\\rho^2(\\ell)]=0$，所以$\\rho(\\ell)=\\pm1$。成立。\n\n## 1.11\n\n(a)\n\n$$\n\\begin{aligned}\n\\gamma(h)&=\\operatorname{cov}(\\sum_k\\psi_kw_{t+h-k},\\sum_j\\psi_jw_{t-j})\\\\\n&=\\operatorname{E}(\\sum_{k=-\\infty}^\\infty\\sum_{j=-\\infty}^\\infty\\psi_k\\psi_jw_{t+h-k}w_{t-j})\\\\\n&=\\sigma_w^2\\sum_{j,k}\\psi_k\\psi_j\\delta_{h-k+j}\\\\\n&=\\sigma_w^2\\sum_{k=-\\infty}^\\infty\\psi_{k+h}\\psi_k\n\\end{aligned}\n$$\n\n:::{.callout-tip}\n对[@sec-1_7]解法进行优化。\n\n$$\n\\begin{aligned}\n\\gamma_x(h)&=\\operatorname{cov}(\\sum_{k=-1}^1\\psi_kw_{t+h-k},\\sum_{j=-1}^1\\psi_jw_{t-j})\\\\\n&=\\sigma_w^2\\sum_{k=-1}^1\\sum_{j=-1}^1\\psi_k\\psi_j\\delta_{h-k+j}\n\\end{aligned}\n$$\n:::\n\n(b)\n\n见原书附录。\n\n## 1.12\n\n$$\n\\gamma_{xy}(h)=\\operatorname{E}[(x_{t+h}-\\mu_x)(y_t-\\mu_y)]=\\operatorname{E}[(y_t-\\mu_y)(x_{t+h}-\\mu_x)]=\\gamma_{yx}(-h)\n$$\n\n## 1.13\n\n(a)\n\n$$\n\\begin{aligned}\n\\gamma_y(h)&=\\operatorname{cov}(w_{t+h}-\\theta w_{t+h-1}+u_{t+h},w_t-\\theta w_{t-1}+u_t)\\\\\n&=\\operatorname{cov}(w_{t+h},w_t)-\\theta\\operatorname{cov}(w_{t+h},w_{t-1})-\\theta\\operatorname{cov}(w_{t+h-1},w_t)+\\theta^2cov(w_{t+h-1},w_{t-1})+\\operatorname{cov}(u_{t+h},u_t)\n\\end{aligned}\n$$\n\n所以\n\n$$\n\\gamma_y(h)=\\begin{cases}\n\\sigma_w^2(1+\\theta^2)+\\sigma_u^2&h=0\\\\\n-\\theta\\sigma_w^2&h=\\pm1\\\\\n0&|h|\\ge2\n\\end{cases}\n$$\n\n所以\n\n$$\n\\rho_y(h)=\\begin{cases}\n1&h=0\\\\\n\\frac{-\\theta\\sigma_w^2}{\\sigma_w^2(1+\\theta^2)+\\sigma_u^2}&h=\\pm1\\\\\n0&|h|\\ge2\n\\end{cases}\n$$\n\n(b)\n\n易得\n\n$$\n\\gamma_x(h)=\\begin{cases}\n\\sigma_w^2&h=0\\\\\n0&h\\neq0\n\\end{cases}\n$$\n\n和\n\n$$\n\\gamma_{xy}(h)=\\operatorname{cov}(w_{t+h},w_t-\\theta w_{t-1}+u_t)=\\begin{cases}\n\\sigma_w^2&h=0\\\\\n-\\theta\\sigma_w^2&h=-1\\\\\n0&\\operatorname{otherwise}\n\\end{cases}\n$$\n\n所以\n\n$$\n\\rho_{xy}(h)=\\frac{\\gamma_{xy}(h)}{\\sqrt{\\gamma_x(0)\\gamma_y(0)}}=\\begin{cases}\n\\frac{\\sigma_w^2}{\\sigma_w^2(2+\\theta^2)+\\sigma_u^2}&h=0\\\\\n\\frac{-\\theta\\sigma_w^2}{\\sigma_w^2(1+\\theta^2)+\\sigma_u^2}&h=-1\\\\\n0&\\operatorname{otherwise}\n\\end{cases}\n$$\n\n(c)\n\n自协方差和交叉协方差都只和$h$有关，所以联合平稳。\n\n## 1.14\n\n(a)\n\n$\\lambda=1$代入：\n\n$$\n\\operatorname{E}(y_t)=\\operatorname{E}[\\exp\\{x_t\\}]=\\exp\\{\\mu_x+\\frac{1}{2}\\gamma(0)\\}\n$$\n\n(b)\n\n$$\n\\gamma_y(h)=\\operatorname{cov}(y_{t+h},y_t)=\\operatorname{E}(y_{t+h}y_t)-\\operatorname{E}(y_{t+h})\\operatorname{E}(y_{t})\n$$\n\n分解一下：\n\n$$\n\\begin{aligned}\n\\operatorname{E}(y_{t+h}y_t)&=\\operatorname{E}[\\exp(x_{t+h})\\exp(x_t)]=\\operatorname{E}[\\exp(x_{t+h}+x_t)]\\\\\n&=\\exp\\{\\operatorname{E}(x_{t+h}+x_t)+\\frac{1}{2}\\operatorname{var}(x_{t+h}+x_t)\\}\n\\end{aligned}\n$$\n\n其中：\n\n$$\n\\operatorname{E}(x_{t+h}+x_t)=2\\mu_x\\\\\n\\operatorname{var}(x_{t+h}+x_t)=\\operatorname{var}(x_{t+h})+\\operatorname{var}(x_t)+2\\operatorname{cov}(x_{t+h},x_t)=2\\gamma(0)+2\\gamma(h)\n$$\n\n所以\n\n$$\n\\operatorname{E}(y_{t+h}y_t)=\\exp\\{2\\mu_x+\\gamma(0)+\\gamma(h)\\}\n$$\n\n所以\n\n$$\n\\begin{aligned}\n\\gamma_y(h)&=\\exp\\{2\\mu_x+\\gamma(0)+\\gamma(h)\\}-(\\exp\\{\\mu_x+\\frac{1}{2}\\gamma(0)\\})^2\\\\\n&=\\exp\\{2\\mu_x+\\gamma(0)+\\gamma(h)\\}-\\exp\\{2\\mu_x+\\gamma(0)\\}\\\\\n&=\\exp\\{2\\mu_x+\\gamma(0)\\}(\\exp\\{\\gamma(h)\\}-1)\n\\end{aligned}\n$$\n\n## 1.15\n\n**均值函数**\n\n$$\n\\mu_t=\\operatorname{E}(w_tw_{t-1})=\\operatorname{E}(w_t)\\operatorname{E}(w_{t-1})=0\n$$\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma_x(h)&=\\operatorname{cov}(w_{t+h}w_{t+h-1},w_tw_{t-1})\\\\\n&=\\operatorname{E}(w_{t+h}w_{t+h-1}w_tw_{t-1})\n\\end{aligned}\n$$\n\n所以\n\n$$\n\\gamma_x(h)=\\begin{cases}\n\\sigma_w^4&h=0\\\\\n\\sigma_w^2&|h|=1\\\\\n0&|h|\\ge2\n\\end{cases}\n$$\n\n均和$t$无关，平稳。\n\n## 1.16\n\n(a)\n\n**均值函数**\n\n$$\n\\begin{aligned}\n\\operatorname{E}(x_t)=\\int_0^1\\sin(2\\pi ut)\\mathrm{d}u=-\\frac{1}{2\\pi t}\\cos(2\\pi ut)\\Bigg|_0^1=-\\frac{1}{2\\pi t}[\\cos(2\\pi t)-1]=0\n\\end{aligned}\n$$\n\n**自协方差函数**\n\n$$\n\\begin{aligned}\n\\gamma(h)&=\\int_0^1\\sin[2\\pi u(t+h)]\\sin[2\\pi ut]\\mathrm{d}u\\\\\n&=\\frac{1}{2}\\int_0^1\\cos(2\\pi uh)\\mathrm{d}u-\\frac{1}{2}\\int_0^1\\cos(2\\pi u(2t + h))\\mathrm{d}u\n\\end{aligned}\n$$\n\n当$h=0$时，$\\gamma(h)=\\frac{1}{2}$\n\n当$h\\neq0$时\n\n$$\n\\gamma(h)=\\frac{1}{2}\\left[\\frac{\\sin(2\\pi h)}{2\\pi h}-\\frac{\\sin(2\\pi (2t+h))}{2\\pi (2t+h)}\\right]=0\n$$\n\n综上，为弱平稳。\n\n(b)\n\n$t=1$、$t=2$、$t=3$代入，$x_1$和$x_2$，$x_2$和$x_3$关系不一样，所以非严平稳。\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"toc-depth":2,"output-file":"Chapter_1_sol.html"},"language":{"toc-title-document":"目录","toc-title-website":"该页面内容","related-formats-title":"其他格式","related-notebooks-title":"笔记本","source-notebooks-prefix":"资源","other-links-title":"其他链接","code-links-title":"代码链接","launch-dev-container-title":"启动 Dev Container","launch-binder-title":"启动 Binder","article-notebook-label":"文章笔记本","notebook-preview-download":"下载笔记本","notebook-preview-download-src":"下载源代码","notebook-preview-back":"返回文章","manuscript-meca-bundle":"MECA 存档","section-title-abstract":"摘要","section-title-appendices":"附录","section-title-footnotes":"脚注","section-title-references":"参考文献","section-title-reuse":"二次使用","section-title-copyright":"版权","section-title-citation":"引用格式","appendix-attribution-cite-as":"请按如下格式引用：","appendix-attribution-bibtex":"BibTeX","title-block-author-single":"作者","title-block-author-plural":"作者","title-block-affiliation-single":"单位","title-block-affiliation-plural":"单位","title-block-published":"发布于","title-block-modified":"修改于","title-block-keywords":"关键词","callout-tip-title":"提示","callout-note-title":"注释","callout-warning-title":"警告","callout-important-title":"重要","callout-caution-title":"注意","code-summary":"代码","code-tools-menu-caption":"代码","code-tools-show-all-code":"显示所有代码","code-tools-hide-all-code":"隐藏所有代码","code-tools-view-source":"查看源代码","code-tools-source-code":"源代码","tools-share":"Share","tools-download":"Download","code-line":"行","code-lines":"行","copy-button-tooltip":"复制到剪贴板","copy-button-tooltip-success":"已复制","repo-action-links-edit":"编辑该页面","repo-action-links-source":"查看代码","repo-action-links-issue":"反馈问题","back-to-top":"回到顶部","search-no-results-text":"没有结果","search-matching-documents-text":"匹配的文档","search-copy-link-title":"复制搜索链接","search-hide-matches-text":"隐藏其它匹配结果","search-more-match-text":"更多匹配结果","search-more-matches-text":"更多匹配结果","search-clear-button-title":"清除","search-text-placeholder":"","search-detached-cancel-button-title":"取消","search-submit-button-title":"提交","search-label":"搜索","toggle-section":"展开或折叠此栏","toggle-sidebar":"展开或折叠侧边栏导航","toggle-dark-mode":"切换深色模式","toggle-reader-mode":"切换阅读器模式","toggle-navigation":"展开或折叠导航栏","crossref-fig-title":"图","crossref-tbl-title":"表","crossref-lst-title":"列表","crossref-thm-title":"定理","crossref-lem-title":"引理","crossref-cor-title":"推论","crossref-prp-title":"命题","crossref-cnj-title":"猜想","crossref-def-title":"定义","crossref-exm-title":"例","crossref-exr-title":"习题","crossref-ch-prefix":"章节","crossref-apx-prefix":"附录","crossref-sec-prefix":"小节","crossref-eq-prefix":"式","crossref-lof-title":"图索引","crossref-lot-title":"表索引","crossref-lol-title":"列表索引","environment-proof-title":"证","environment-remark-title":"注记","environment-solution-title":"解","listing-page-order-by":"排序方式","listing-page-order-by-default":"默认","listing-page-order-by-date-asc":"日期升序","listing-page-order-by-date-desc":"日期降序","listing-page-order-by-number-desc":"降序","listing-page-order-by-number-asc":"升序","listing-page-field-date":"日期","listing-page-field-title":"标题","listing-page-field-description":"描述","listing-page-field-author":"作者","listing-page-field-filename":"文件名","listing-page-field-filemodified":"修改时间","listing-page-field-subtitle":"副标题","listing-page-field-readingtime":"阅读时间","listing-page-field-wordcount":"字数统计","listing-page-field-categories":"分类","listing-page-minutes-compact":"{0} 分钟","listing-page-category-all":"全部","listing-page-no-matches":"无匹配项","listing-page-words":"{0} 字"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.555","editor":"visual","theme":"cosmo","title-block-banner":true,"title":"时间序列分析：第一章习题答案","author":"周博霖","date":"2024/9/7","categories":["学习笔记","统计方法","时间序列分析"],"image":"cover.png","bibliography":["references.bib"],"csl":"apa.csl"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}