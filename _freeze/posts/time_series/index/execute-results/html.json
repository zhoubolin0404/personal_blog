{
  "hash": "b48317160cce204b420880a5debb2474",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"时间序列分析：第一章\"\nauthor: \"周博霖\"\ndate: \"2024/8/10\"\ncategories: [学习笔记,统计方法,时间序列分析]\nimage: \"cover.png\"\nbibliography: references.bib\ncsl: apa.csl\nnumber-sections: true\ntoc: true\ntoc-depth: 2\ndate-modified: \"2024/8/23\"\n---\n\n\n\n\n主要参考书籍为Shumway和Stoffer[-@Shumway_2017]的Time Series Analysis and Its Applications: With R Examples。\n\n该书第五版正在制作，配套`astsa`包中的部分数据集会逐渐更新，所以后期也许会换成第五版内容。\n\n该内容为学习笔记，会很碎片化，同时参考了作者在[github](https://github.com/nickpoison/tsa4/blob/master/textRcode.md)上给出的代码。\n\n时间序列分析适用情境：\n\n* **金融**：每日股市配额、每月失业人口\n* **社会科学**：人口序列\n* **流行病学**：一段时间内流感人数\n* **药学**：一段时间内血压测量\n* **fMRI**：脑成像的时间序列\n等\n\n两种不同但不一定互斥的时间序列分析方法：\n\n* **时域方法**(*time domain approach*)：对滞后关系的研究最重要(例如：今天发生的事如何影响明天将要发生的事)\n* **频域方法**(*frequency domain approach*)：对周期的研究最重要(例如：繁荣和萧条时期是什么样的经济周期)\n\n# 时间序列数据\n\n## 强生公司季度每股收益\n\n`jj`：强生公司的季度每股收益，从1960年第一季度到1980年最后一季度的84个季度(共21年)。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(astsa)\njj\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Qtr1      Qtr2      Qtr3      Qtr4\n1960  0.710000  0.630000  0.850000  0.440000\n1961  0.610000  0.690000  0.920000  0.550000\n1962  0.720000  0.770000  0.920000  0.600000\n1963  0.830000  0.800000  1.000000  0.770000\n1964  0.920000  1.000000  1.240000  1.000000\n1965  1.160000  1.300000  1.450000  1.250000\n1966  1.260000  1.380000  1.860000  1.560000\n1967  1.530000  1.590000  1.830000  1.860000\n1968  1.530000  2.070000  2.340000  2.250000\n1969  2.160000  2.430000  2.700000  2.250000\n1970  2.790000  3.420000  3.690000  3.600000\n1971  3.600000  4.320000  4.320000  4.050000\n1972  4.860000  5.040000  5.040000  4.410000\n1973  5.580000  5.850000  6.570000  5.310000\n1974  6.030000  6.390000  6.930000  5.850000\n1975  6.930000  7.740000  7.830000  6.120000\n1976  7.740000  8.910000  8.280000  6.840000\n1977  9.540000 10.260000  9.540000  8.729999\n1978 11.880000 12.060000 12.150000  8.910000\n1979 14.040000 12.960000 14.850000  9.990000\n1980 16.200000 14.670000 16.020000 11.610000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsplot(jj, col = 4, type = \"o\", xlab = \"时间\", ylab = \"季度每股收益\")\n```\n\n::: {.cell-output-display}\n![强生公司季度每股收益](index_files/figure-html/fig-强生公司季度每股收益-1.png){#fig-强生公司季度每股收益 width=672}\n:::\n:::\n\n\n## 全球变暖\n\n这里我使用了最新数据，老数据`globtemp`计划被删除。\n\n`gtemp_land`：1850年到2023年，每年地球陆地年平均温度偏差(以摄氏度为单位，相对于1991-2020年的平均值)。\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngtemp_land\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTime Series:\nStart = 1850 \nEnd = 2023 \nFrequency = 1 \n  [1] -0.50 -0.60 -0.50 -0.50 -0.20 -0.50 -0.80 -0.40 -0.40 -0.10 -0.70 -0.20\n [13] -0.50 -0.20 -0.30 -0.60 -0.40 -0.60 -0.30 -0.50 -0.20 -0.10 -0.40 -0.30\n [25] -0.40 -0.50 -0.20 -0.10  0.26 -0.20 -0.50 -0.40 -0.20 -0.40 -0.70 -0.40\n [37] -0.50 -0.30 -0.70  0.00 -0.20 -0.30 -0.50 -0.40  0.10 -0.50 -0.50 -0.70\n [49] -1.10 -0.50  0.00  0.21 -0.40  0.05 -0.60 -0.70 -0.30 -0.30 -0.80 -0.70\n [61] -0.50 -0.80 -0.70 -0.40 -0.10 -0.20 -0.50 -1.00 -0.30 -0.50  0.05 -0.10\n [73]  0.00 -0.30  0.01 -0.20  0.53 -0.60 -0.20 -0.30  0.21 -0.10 -0.10 -0.30\n [85] -0.30  0.13 -0.30 -0.40  0.38 -0.20  0.06 -0.10 -0.10  0.00  0.36  0.00\n [97]  0.00  0.32 -0.30  0.24  0.00 -0.20 -0.30  0.33 -0.30 -0.60 -0.20 -0.30\n[109]  0.03  0.49 -0.90  0.08  0.36 -0.40 -0.30 -0.10 -0.10  0.19  0.80 -0.20\n[121]  0.00  0.00  0.13  0.61  0.18  0.32 -0.20  0.29  0.37  0.10  0.19  0.85\n[133]  0.00  0.64  0.36  0.42  0.67 -0.20  0.51  0.66  1.61  0.45  0.78  0.64\n[145]  0.41  0.75  0.44  0.81  0.94  0.36  1.14  0.85  1.58  0.84  1.02  1.36\n[157]  1.20  1.27  1.65  0.83  1.54  1.27  0.93  1.10  1.52  1.76  2.50  2.15\n[169]  1.63  2.14  1.95  1.58  2.13  2.26\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsplot(gtemp_land, col = 4, type = \"o\", xlab = \"时间\", ylab = \"全球温度偏差/℃\")\n```\n\n::: {.cell-output-display}\n![全球陆地年平均温度偏差(1850-2023)](index_files/figure-html/fig-gm-1.png){#fig-gm width=672}\n:::\n:::\n\n\n## 语音数据\n\n`speech`：为“aaa…hhh”这一短语录制的0.1秒(1000采样点)语音样本。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nattributes(speech)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$tsp\n[1]    1 1020    1\n\n$class\n[1] \"ts\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsplot(speech)\n```\n\n::: {.cell-output-display}\n![10000点每秒速度采样的音节aaa···hhh的语音记录，n = 1020](index_files/figure-html/fig-语音数据-1.png){#fig-语音数据 width=672}\n:::\n:::\n\n\n## 道琼斯工业平均指数\n\n`djia`：从2006年4月20日到2016年4月20日，道琼斯工业平均指数的每日数值\n\n`djia`数据目前只使用其中的收盘价(`Close`，不确定是昨收还是今收，不过这也不重要)。\n\n假设$x_t$是实际值，则$r_t=\\frac{x_t-x_{t-1}}{x_{t-1}}$是收益率，那么$1+r_t=\\frac{x_t}{x_{t-1}}$，则有$log(1+r_t)=log(\\frac{x_t}{x_{t-1}})=log(x_t)-log(x_{t-1})\\approx r_t$($r_t$很小，泰勒级数展开后成立)。\n\n`djiar`为2006年4月21日到2016年4月20日的日收益率。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(xts)\ndjiar = diff(log(djia$Close))[-1]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(djiar, col = 4, main = \"DJIA Returns\") \n```\n\n::: {.cell-output-display}\n![DJIA日收益率](index_files/figure-html/fig-djiar-1.png){#fig-djiar width=672}\n:::\n:::\n\n\n## 厄尔尼诺和鱼群\n\n`soi`：1950-1987年间453个月的南方涛动指数(SOI)\n\n`rec`：1950-1987年间453个月的新鱼数量指数(Recruitment)\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 1)) \ntsplot(soi, col = 4, xlab = \"\", ylab = \"\", main = \"Southern Oscillation Index\")\ntsplot(rec, col = 4, xlab = \"\", ylab = \"\", main = \"Recruitment\") \n```\n\n::: {.cell-output-display}\n![每月SOI和新鱼数量指数](index_files/figure-html/fig-SOI-1.png){#fig-SOI width=672}\n:::\n:::\n\n\n## fMRI成像\n\n`fmri1`：由8个位置的平均fMRI 血氧水平依赖(BOLD)信号组成的数据集。刺激持续32秒，然后停止32秒。信号周期为64秒，采样率为每2秒1次，采样时间为256秒($n=128$)。\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 1))  \ntsplot(fmri1[, 2:5], col = 1:4, ylab = \"BOLD\", main = \"大脑皮层\", spaghetti = TRUE)\ntsplot(fmri1[, 6:9], col = 1:4, ylab = \"BOLD\", main = \"丘脑和小脑\", spaghetti = TRUE)\n```\n\n::: {.cell-output-display}\n![大脑皮层、丘脑、小脑各部位的fMRI数据](index_files/figure-html/fig-fMRI-1.png){#fig-fMRI width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsplot(fmri1[, 2:9], col = 1:8, lwd = 2, ncol = 2, ylim = c(-.6,.6))\n```\n\n::: {.cell-output-display}\n![分别展示](index_files/figure-html/fig-fMRI_each-1.png){#fig-fMRI_each width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx = ts(fmri1[, 4:9], start = 0, freq = 32)         \nnames = c(\"大脑皮层\", \"丘脑\", \"小脑\")\nu = ts(rep(c(rep(.6, 16), rep(-.6, 16)), 4), start = 0, freq = 32)\npar(mfrow = c(3, 1))\nfor (i in 1:3){ \n  j = 2*i - 1\n  tsplot(x[, j:(j+1)], ylab = \"BOLD\", xlab = \"\", main = names[i], col = 5:6, ylim = c(-.6, .6), \n         lwd = 2, xaxt = \"n\", spaghetti = TRUE)\n  axis(seq(0, 256, 64), side = 1, at = 0:4)\n  lines(u, type = \"s\", col = gray(.3)) \n}\nmtext(\"seconds\", side = 1, line = 1.75, cex = .9)\n```\n\n::: {.cell-output-display}\n![包含刺激信息](index_files/figure-html/fig-fMRI_each_2-1.png){#fig-fMRI_each_2 width=672}\n:::\n:::\n\n\n## 地震和爆炸\n\n`EQ5`：某地区地震的纵波和横波(两阶段)\n`EXP6`：某地区爆炸的纵波和横波(两阶段)\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = 2:1)\ntsplot(EQ5,  col = 4, main = \"地震\")\ntsplot(EXP6, col = 4, main = \"爆炸\")\n```\n\n::: {.cell-output-display}\n![地震和爆炸两阶段，1秒40个采样点](index_files/figure-html/fig-earthquakes-1.png){#fig-earthquakes width=672}\n:::\n:::\n\n\n# 时间序列统计模型\n\n## 白噪声(White Noise)\n\n白噪声：符合$w_t\\sim wn(0,\\sigma_w^2)$的不相关随机变量\n\n独立同分布(independent and identically distributed，iid)的噪声：$w_t\\sim iid(0,\\sigma_w^2)$\n\n高斯白噪声(Gaussian white noise)：$w_t\\sim iidN(0,\\sigma_w^2)$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nw = rnorm(500, 0, 1)                                   # 500 N(0,1) variates\nv = stats::filter(w, sides = 2, filter = rep(1/3, 3))  # moving average\npar(mfrow = c(2, 1))\ntsplot(w, col = 4, main = \"white noise\")\ntsplot(v, col = 4, ylim = c(-3, 3), main = \"moving average\")\n```\n\n::: {.cell-output-display}\n![高斯白噪声序列(上)和高斯白噪声序列的三点移动平均值(下)](index_files/figure-html/fig-white_noise-1.png){#fig-white_noise width=672}\n:::\n:::\n\n\n## 移动平均值(Moving Averages)和过滤(Filtering){#sec-moveave}\n\n用移动平均值$v_t$替换，从而对$w_t$进行平滑处理。[@fig-white_noise]下方图片就是三点移动平均值，其中$v_t=\\frac{1}{3}(w_{t-1}+w_t+w_{t+1})$。从实际效果来讲，实现了较慢的振荡被突出，较快的振荡被掩盖。这种序列一般称为**滤波序列**(*filtered series*)。\n\n`filter()`函数通俗来讲是用来消除噪声的(滤波)，生成[@fig-white_noise]的代码中，参数`filter = rep(1/3, 3)`其实就是`filter = c(1/3, 1/3, 1/3)`，分别表示$w_{t+1}$、$w_t$和$w_{t-1}$的系数。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfilter(x,                # ts数据\n       filter,           # 一个逆时间顺序的滤波器系数向量\n       method = c(\"convolution\", \"recursive\"), # 卷积和递归，卷积是移动平均，递归是自回归，默认卷积\n       sides = 2,        # 只用于卷积，1表示单边滤波(只考虑前面的值)，2表示双边滤波(两边都考虑)\n       circular = F,     # 只用于卷积，是否末尾和开头相连\n       init)             # 只用于递归，初始值，默认0\n```\n:::\n\n\n## 自回归(Autoregressions)\n\n可以换种方式替换$w_t$，即$x_t=x_{t-1}-0.9x_{t-2}+w_t$。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1)\nw = rnorm(550,0,1)  # 50 extra to avoid startup problems\nx = stats::filter(w, filter = c(1, -.9), method = \"recursive\")[-(1:50)]\ntsplot(x, col = 4, main = \"自回归\")\n```\n\n::: {.cell-output-display}\n![自回归序列](index_files/figure-html/fig-autoregressions-1.png){#fig-autoregressions width=672}\n:::\n:::\n\n\n生成[@fig-autoregressions]的代码中，`init`参数默认为0，即$x_1=w_1$、$x_2=x_1+w_2=w_1+w_2$，之后$x_3=x_2-0.9x_1+w_3$。$x_1$和$x_2$显然是不符合要求的，常用方法是去除这一部分，生成[@fig-autoregressions]的代码中多生成了50个数据，之后去除了。\n\n## 带漂移项(Drift)的随机游走(Random Walk)\n\n带漂移项的随机游走模型适合处理[@fig-gm]所展示的全球变暖相关数据。该模型中\n\n$$\nx_t=\\delta+x_{t-1}+w_t\n$${#eq-rw}\n\n其中$t=1,\\ 2,\\ \\cdots$，$x_0=0$，$w_t$为白噪声，常数$\\delta$为漂移项。当$\\delta=0$时，[@eq-rw]为随机游走。\n\n[@eq-rw]还可以转化为$x_t=\\delta t+\\sum_{j=1}^{t}w_j$，可见当$\\delta=0$时，$x_t$就是白噪声累加和。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(154)\nw = rnorm(200)\nx = cumsum(w)\nwd = w + .2\nxd = cumsum(wd)\ntsplot(xd, ylim = c(-5, 55), main = \"random walk\", ylab = '')\nlines(x, col = 4) \nclip(0, 200, 0, 50)\nabline(h = 0, col = 4, lty = 2)\nabline(a = 0, b = .2, lty = 2)\n```\n\n::: {.cell-output-display}\n![随机游走图](index_files/figure-html/fig-rw-1.png){#fig-rw width=672}\n:::\n:::\n\n\n[@fig-rw]中$\\sigma_w=1$，黑色实线的漂移项$\\delta=0.2$，黑色虚线是斜率为0.2的直线，蓝色实线为随机游走(无漂移项，即$\\delta=0$)，蓝色虚线表示$y=0$的直线。\n\n## 噪声信号(Signal in Noise)\n\n很多时间序列模型都是假设由固定周期性变化的信号和随机噪声叠加构成的，[@fig-fMRI]所表示的fMRI序列就有很明显的周期性。\n\n现在令：\n\n$$\nx_t=2\\cos(2\\pi\\frac{t+15}{50})+w_t\n$${#eq-cos}\n\n其中$t=1,\\ 2,\\ \\cdots,\\ 500$，第一项$2\\cos(2\\pi\\frac{t+15}{50})$就是信号。\n\n正弦波形还可以写成：\n\n$$\nA\\cos(2\\pi\\omega t+\\phi)\n$$\n\n其中$A$是振幅，$\\omega$是振荡频率，$\\phi$是相位。[@eq-cos]中$A=2$，$\\omega=\\frac{1}{50}$(50个时间点为一个周期)，$\\phi=\\frac{2\\pi15}{50}=0.6\\pi$。\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncs = 2 * cos(2 * pi * (1:500) / 50 + .6 * pi)\nw = rnorm(500, 0, 1)\npar(mfrow = c(3, 1))\ntsplot(cs, ylab = \"\", main = expression(x[t] == 2 * cos(2 * pi * t / 50 + .6 * pi)))\ntsplot(cs + w, ylab = \"\", main = expression(x[t] == 2 * cos(2 * pi * t / 50 + .6 * pi) + N(0, 1)))\ntsplot(cs + 5 * w, ylab = \"\", main = expression(x[t] == 2 * cos(2 * pi * t / 50 + .6 * pi) + N(0, 25)))\n```\n\n::: {.cell-output-display}\n![余弦波和可加性高斯白噪声污染的余弦图](index_files/figure-html/fig-cos-1.png){#fig-cos width=672}\n:::\n:::\n\n\n[@fig-cos]中间的图和下面的图分别加上了$\\sigma_w=1$和$\\sigma_w=5$的白噪声。信号被遮掩的程度取决于信号幅度和$\\sigma_w$的大小。信号幅度和$\\sigma_w$之比称为信噪比(signal-to-noise ratio，SNR)。SNR越大，检测信号就越容易，反之越难。例如[@fig-cos]中，中间的图就比较容易看出信号，下面的图就比较困难。通常我们关心的是信号。\n\n# 相关性测量\n\n相关性是时间序列分析的基本特征，所以最常用的描述性度量是协方差和相关函数。边际分布函数$F_t(x)=P\\{x_t\\leq x\\}$、相应的边际密度函数$f_t(x)=\\frac{\\partial F_t(x)}{\\partial x}$和平均函数都是有用的边际描述指标。\n\n## 平均函数\n\n$$\n\\mu_{xt}=\\operatorname{E}(x_t)=\\int_{-\\infty}^{\\infty}xf_t(x)\\operatorname{d}x\n$$\n\n### 移动平均序列的平均函数\n\n平均函数和白噪声相同，以[@fig-white_noise]里的情况为例。\n\n白噪声序列$w_t$有$\\mu_{wt}=\\operatorname{E}(w_t)=0$，进行平滑后有$\\mu_{vt}=\\operatorname{E}(v_t)=\\frac{1}{3}[\\operatorname{E}(w_{t-1})+\\operatorname{E}(w_t)+\\operatorname{E}(w_{t-1})]=0$，平均函数不变。\n\n### 带漂移项的随机游走的平均函数\n\n平均函数为一条直线，以[@eq-rw]为例。\n\n已知$\\operatorname{E}(w_t)=0$，$\\delta$为常数，有：\n\n$$\n\\mu_{x_t}=\\operatorname{E}(x_t)=\\delta t+\\sum_{j=1}^{t}\\operatorname{E}(w_j)=\\delta t\n$$\n\n这是一条斜率为$\\delta$的直线，[@fig-rw]中的虚线就是其平均函数。\n\n### 信号加噪声的平均函数\n\n平均函数为余弦波，以[@eq-cos]为例。\n\n$$\n\\mu_{xt}=\\operatorname{E}(x_t)=\\operatorname{E}[2cos(2\\pi\\frac{t+15}{50})+w_t]=2cos(2\\pi\\frac{t+15}{50})+\\operatorname{E}(w_t)=2cos(2\\pi\\frac{t+15}{50})\n$$\n\n## 自协方差函数(Autocovariance Function)\n\n对于任意$s$和$t$，**自协方差函数**被定义为二阶矩函数：\n\n$$\n\\gamma_x(s,t)=\\operatorname{cov}(x_s,x_t)=\\operatorname{E}[(x_s-\\mu_s)(x_t-\\mu_t)]\n$$\n\n自协方差衡量在不同时间观察到的同一时间序列的两点间的*线性*依赖性。平滑的时间序列，即使$t$和$s$相隔很远，自协方差函数也会比较大；而波动大的时间序列，自协方差函数几乎为0。\n\n从经典统计数据角度来看，如果$\\gamma_x(s,t)=0$，$x_s$和$x_t$非线性相关(可能有其他依赖结构)。但如果$x_s$和$x_t$是二元正态分布，$\\gamma_x(s,t)=0$说明相互独立。对于$s=t$，自协方差就是方差，即：\n\n$$\n\\gamma_x(t,t)=\\operatorname{E}[(x_t-\\mu_t)^2]=\\operatorname{var}(x_t)\n$$\n\n### 白噪声的自协方差\n\n白噪声序列$w_t$有$\\operatorname{E}(w_t)=0$，且\n\n$$\n\\gamma_w(s,t)=\\operatorname{cov}(w_s,w_t)=\\begin{cases}\n\\sigma_w^2 & s=t\\\\\n0 & s\\neq t\n\\end{cases}\n$$\n\n### 线性组合的协方差\n\n我们经常要计算滤波序列之间的自协方差，可以用到下面的性质：\n\n如果有随机变量\n\n$$\nU=\\sum_{j=1}^ma_jX_j\\ 和\\ V=\\sum_{k=1}^rb_kY_k\n$$\n\n分别是随机变量$\\{X_j\\}$和$\\{Y_k\\}$的线性组合，则它们的协方差为：\n\n$$\n\\operatorname{cov}(U,V)=\\sum_{j=1}^m\\sum_{k=1}^ra_jb_k\\operatorname{cov}(X_j,Y_k)\n$$\n\n且$\\operatorname{var}(U)=\\operatorname{cov}(U,U)$。\n\n### 移动平均值的自协方差\n\n以[@sec-moveave]中的例子为例。变换后的滤波序列有：\n\n$$\n\\gamma_v(s,t)=\\operatorname{cov}(v_s,v_t)=\\operatorname{cov}\\{\\frac{1}{3}(w_{s-1}+w_s+w_{s+1}),\\frac{1}{3}(w_{t-1}+w_t+w_{t+1})\\}\n$$\n\n当$s=t$时：\n\n$$\n\\begin{aligned}\n\\gamma_v(t,t)&=\\frac{1}{9}\\operatorname{cov}\\{(w_{t-1}+w_t+w_{t+1}),(w_{t-1}+w_t+w_{t+1})\\}\\\\\n&=\\frac{1}{9}[\\operatorname{cov}(w_{t-1},w_{t-1})+\\operatorname{cov}(w_{t},w_{t})+\\operatorname{cov}(w_{t+1},w_{t+1})]\\\\\n&=\\frac{3}{9}\\sigma_w^2\n\\end{aligned}\n$$\n\n当$s=t+1$时：\n\n$$\n\\begin{aligned}\n\\gamma_v(t+1,t)&=\\frac{1}{9}\\operatorname{cov}\\{(w_t+w_{t+1}+w_{t+2}),(w_{t-1}+w_t+w_{t+1})\\}\\\\\n&=\\frac{1}{9}[\\operatorname{cov}(w_t,w_t)+\\operatorname{cov}(w_{t+1},w_{t+1})+\\operatorname{cov}(w_{t+2},w_{t-1})]\\\\\n&=\\frac{1}{9}[\\operatorname{cov}(w_t,w_t)+\\operatorname{cov}(w_{t+1},w_{t+1})+0]\\\\\n&=\\frac{2}{9}\\sigma_w^2\n\\end{aligned}\n$$\n\n通过类似计算，我们得到$\\gamma_v(t-1,t)=\\gamma_v(t+1,t)=\\frac{2}{9}\\sigma_w^2$，$\\gamma_v(t-2,t)=\\gamma_v(t+2,t)=\\frac{1}{9}\\sigma_w^2$，当$|t-s|>2$时为0。即：\n\n$$\n\\gamma_v(s,t)=\\begin{cases}\n\\frac{3}{9}\\sigma_w^2&s=t\\\\\n\\frac{2}{9}\\sigma_w^2&|s-t|=1\\\\\n\\frac{1}{9}\\sigma_w^2&|s-t|=2\\\\\n0&|s-t|>2\n\\end{cases}\n$$\n\n平滑后序列的协方差函数随两时间点间的间隔增加而减小，其协方差只取决于时间间隔或滞后，不取决于时间点在时间序列中的绝对位置。\n\n### 随机游走的自协方差\n\n随机游走模型$x_t=\\sum_{j=1}^tw_j$，有\n\n$$\n\\gamma_x(s,t)=\\operatorname{cov}(x_s,x_t)=\\operatorname{cov}(\\sum_{j=1}^sw_j,\\sum_{k=1}^tw_k)=\\operatorname{min}\\{s,t\\}\\sigma_w^2\n$$\n\n随机游走的自协方差函数取决于特定的时间值$s$和$t$，不取决于时间间隔或滞后。且$\\operatorname{var}(x_t)=\\gamma_x(t,t)=t\\sigma_w^2$。\n\n## 自相关函数(autocorrelation function，ACF)\n\n$$\n\\rho(s,t)=\\frac{\\gamma(s,t)}{\\sqrt{\\gamma(s,s)\\gamma(t,t)}}\n$$\n\nACF用来衡量序列中不同时间点之间的依赖性，常用来检测周期性、趋势和模式。\n\n### 交叉协方差函数(cross-covariance function)\n\n$$\n\\gamma_{xy}(s,t)=\\operatorname{cov}(x_s,y_t)=\\operatorname{E}[(x_s-\\mu_{xs})(y_t-\\mu_{yt})]\n$$\n\n交叉协方差函数用于衡量两个时间序列在不同滞后下的协方差。\n\n### 交叉相关函数(cross-correlation function，CCF)\n\n$$\n\\rho_{xy}(s,t)=\\frac{\\gamma_{xy}(s,t)}{\\sqrt{\\gamma_x(s,s)\\gamma_y(t,t)}}\n$$\n\nCCF用于衡量两个时间序列之间在不同滞后下的线性关系。它类似于自相关函数，但用于评估两个不同时间序列之间的相关性，而不仅仅是同一个序列的内部相关性。\n\n# 平稳时间序列(Stationary Time Series)\n\n## 严格平稳(strictly stationary)\n\n如果时间序列每个值的集合$\\{x_{t_1},\\ x_{t_2},\\ \\cdots,\\ x_{t_k}\\}$的概率等于时间移动后值的集合$\\{x_{t_1+h},\\ x_{t_2+h},\\ \\cdots,\\ x_{t_k+h}\\}$的概率，即\n\n$$\n\\Pr\\{x_{t_1}\\le c_1,\\cdots,x_{t_k}\\le c_k\\}=\\Pr\\{x_{t_1+h}\\le c_1,\\cdots,x_{t_k+h}\\le c_k\\}\n$${#eq-stationary}\n\n其中所有$k=1,\\ 2,\\ \\cdots$，所有时间点$t_1,\\ t_2,\\ \\cdots,\\ t_k$，所有数值$c_1,\\ c_2,\\ \\cdots,\\ c_k$和所有时间移动$h=0,\\ \\pm1,\\ \\pm2,\\ \\cdots$。\n\n当$k=1$时，[@eq-stationary]变为对任意$s$和$t$\n\n$$\n\\Pr\\{x_s\\le c\\}=\\Pr\\{x_t\\le c\\}\n$${#eq-stationaryk1}\n\n可见严格平稳的时间序列对于所有$s$和$t$，$\\mu_s=\\mu_t$，因此$\\mu_t$必定为常数。\n\n当$k=2$时，[@eq-stationary]又变为对任意$s$和$t$以及位移$h$\n\n$$\n\\Pr\\{x_s\\le c_1,x_t\\le c_2\\}=\\Pr\\{x_{s+h}\\le c_1,x_{t+h}\\le c_2\\}\n$${#eq-stationaryk2}\n\n根据[@eq-stationaryk1]和[@eq-stationaryk2]可推知，对任意$s$和$t$以及位移$h$\n\n$$\n\\gamma(s,t)=\\gamma(s+h,t+h)\n$$\n\n严格平稳的时间序列自协方差函数取决于$s$和$t$之间的时间差异，而不是具体时间点。\n\n## 弱平稳(Weakly Stationary)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}