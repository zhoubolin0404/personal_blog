{
  "hash": "77f307ad125868f9c337fff363f3d7b8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"时间序列分析：第一章_1\"\nauthor: \"周博霖\"\ndate: \"2024/8/12\"\ncategories: [学习笔记,统计方法,时间序列分析]\nimage: \"cover.png\"\nbibliography: references.bib\ncsl: apa.csl\nnumber-sections: true\ntoc: true\ntoc-depth: 2\n---\n\n\n\n\n主要参考书籍为Shumway和Stoffer[-@Shumway_2017]的Time Series Analysis and Its Applications: With R Examples。\n\n该书第五版正在制作，配套`astsa`包中的部分数据集会逐渐更新，所以后期也许会换成第五版内容。\n\n该内容为学习笔记，会很碎片化，同时参考了作者在[github](https://github.com/nickpoison/tsa4/blob/master/textRcode.md)上给出的代码。\n\n时间序列分析适用情境：\n\n* **金融**：每日股市配额、每月失业人口\n* **社会科学**：人口序列\n* **流行病学**：一段时间内流感人数\n* **药学**：一段时间内血压测量\n* **fMRI**：脑成像的时间序列\n等\n\n两种不同但不一定互斥的时间序列分析方法：\n\n* **时域方法**(*time domain approach*)：对滞后关系的研究最重要(例如：今天发生的事如何影响明天将要发生的事)\n* **频域方法**(*frequency domain approach*)：对周期的研究最重要(例如：繁荣和萧条时期是什么样的经济周期)\n\n# 时间序列数据\n\n## 强生公司季度每股收益\n\n`jj`：强生公司的季度每股收益，从1960年第一季度到1980年最后一季度的84个季度(共21年)。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(astsa)\njj\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n          Qtr1      Qtr2      Qtr3      Qtr4\n1960  0.710000  0.630000  0.850000  0.440000\n1961  0.610000  0.690000  0.920000  0.550000\n1962  0.720000  0.770000  0.920000  0.600000\n1963  0.830000  0.800000  1.000000  0.770000\n1964  0.920000  1.000000  1.240000  1.000000\n1965  1.160000  1.300000  1.450000  1.250000\n1966  1.260000  1.380000  1.860000  1.560000\n1967  1.530000  1.590000  1.830000  1.860000\n1968  1.530000  2.070000  2.340000  2.250000\n1969  2.160000  2.430000  2.700000  2.250000\n1970  2.790000  3.420000  3.690000  3.600000\n1971  3.600000  4.320000  4.320000  4.050000\n1972  4.860000  5.040000  5.040000  4.410000\n1973  5.580000  5.850000  6.570000  5.310000\n1974  6.030000  6.390000  6.930000  5.850000\n1975  6.930000  7.740000  7.830000  6.120000\n1976  7.740000  8.910000  8.280000  6.840000\n1977  9.540000 10.260000  9.540000  8.729999\n1978 11.880000 12.060000 12.150000  8.910000\n1979 14.040000 12.960000 14.850000  9.990000\n1980 16.200000 14.670000 16.020000 11.610000\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsplot(jj, col = 4, type = \"o\", xlab = \"时间\", ylab = \"季度每股收益\")\n```\n\n::: {.cell-output-display}\n![强生公司季度每股收益](index_files/figure-html/fig-强生公司季度每股收益-1.png){#fig-强生公司季度每股收益 width=672}\n:::\n:::\n\n\n## 全球变暖\n\n这里我使用了最新数据，老数据`globtemp`计划被删除。\n\n`gtemp_land`：1850年到2023年，每年地球陆地年平均温度偏差(以摄氏度为单位，相对于1991-2020年的平均值)。\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngtemp_land\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nTime Series:\nStart = 1850 \nEnd = 2023 \nFrequency = 1 \n  [1] -0.50 -0.60 -0.50 -0.50 -0.20 -0.50 -0.80 -0.40 -0.40 -0.10 -0.70 -0.20\n [13] -0.50 -0.20 -0.30 -0.60 -0.40 -0.60 -0.30 -0.50 -0.20 -0.10 -0.40 -0.30\n [25] -0.40 -0.50 -0.20 -0.10  0.26 -0.20 -0.50 -0.40 -0.20 -0.40 -0.70 -0.40\n [37] -0.50 -0.30 -0.70  0.00 -0.20 -0.30 -0.50 -0.40  0.10 -0.50 -0.50 -0.70\n [49] -1.10 -0.50  0.00  0.21 -0.40  0.05 -0.60 -0.70 -0.30 -0.30 -0.80 -0.70\n [61] -0.50 -0.80 -0.70 -0.40 -0.10 -0.20 -0.50 -1.00 -0.30 -0.50  0.05 -0.10\n [73]  0.00 -0.30  0.01 -0.20  0.53 -0.60 -0.20 -0.30  0.21 -0.10 -0.10 -0.30\n [85] -0.30  0.13 -0.30 -0.40  0.38 -0.20  0.06 -0.10 -0.10  0.00  0.36  0.00\n [97]  0.00  0.32 -0.30  0.24  0.00 -0.20 -0.30  0.33 -0.30 -0.60 -0.20 -0.30\n[109]  0.03  0.49 -0.90  0.08  0.36 -0.40 -0.30 -0.10 -0.10  0.19  0.80 -0.20\n[121]  0.00  0.00  0.13  0.61  0.18  0.32 -0.20  0.29  0.37  0.10  0.19  0.85\n[133]  0.00  0.64  0.36  0.42  0.67 -0.20  0.51  0.66  1.61  0.45  0.78  0.64\n[145]  0.41  0.75  0.44  0.81  0.94  0.36  1.14  0.85  1.58  0.84  1.02  1.36\n[157]  1.20  1.27  1.65  0.83  1.54  1.27  0.93  1.10  1.52  1.76  2.50  2.15\n[169]  1.63  2.14  1.95  1.58  2.13  2.26\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsplot(gtemp_land, col = 4, type = \"o\", xlab = \"时间\", ylab = \"全球温度偏差/℃\")\n```\n\n::: {.cell-output-display}\n![全球陆地年平均温度偏差(1850-2023)](index_files/figure-html/fig-全球变暖-1.png){#fig-全球变暖 width=672}\n:::\n:::\n\n\n## 语音数据\n\n`speech`：为“aaa…hhh”这一短语录制的0.1秒(1000采样点)语音样本。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nattributes(speech)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$tsp\n[1]    1 1020    1\n\n$class\n[1] \"ts\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsplot(speech)\n```\n\n::: {.cell-output-display}\n![10000点每秒速度采样的音节aaa···hhh的语音记录，n = 1020](index_files/figure-html/fig-语音数据-1.png){#fig-语音数据 width=672}\n:::\n:::\n\n\n## 道琼斯工业平均指数\n\n`djia`：从2006年4月20日到2016年4月20日，道琼斯工业平均指数的每日数值\n\n`djia`数据目前只使用其中的收盘价(`Close`，不确定是昨收还是今收，不过这也不重要)。\n\n假设$x_t$是实际值，则$r_t=\\frac{x_t-x_{t-1}}{x_{t-1}}$是收益率，那么$1+r_t=\\frac{x_t}{x_{t-1}}$，则有$log(1+r_t)=log(\\frac{x_t}{x_{t-1}})=log(x_t)-log(x_{t-1})\\approx r_t$($r_t$很小，泰勒级数展开后成立)。\n\n`djiar`为2006年4月21日到2016年4月20日的日收益率。\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(xts)\ndjiar = diff(log(djia$Close))[-1]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(djiar, col = 4, main = \"DJIA Returns\") \n```\n\n::: {.cell-output-display}\n![DJIA日收益率](index_files/figure-html/fig-djiar-1.png){#fig-djiar width=672}\n:::\n:::\n\n\n## 厄尔尼诺和鱼群\n\n`soi`：1950-1987年间453个月的南方涛动指数(SOI)\n\n`rec`：1950-1987年间453个月的新鱼数量指数(Recruitment)\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 1)) \ntsplot(soi, col = 4, xlab = \"\", ylab = \"\", main = \"Southern Oscillation Index\")\ntsplot(rec, col = 4, xlab = \"\", ylab = \"\", main = \"Recruitment\") \n```\n\n::: {.cell-output-display}\n![每月SOI和新鱼数量指数](index_files/figure-html/fig-SOI-1.png){#fig-SOI width=672}\n:::\n:::\n\n\n## fMRi成像\n\n`fmri1`：由8个位置的平均fMRI 血氧水平依赖(BOLD)信号组成的数据集。刺激持续32秒，然后停止32秒。信号周期为64秒，采样率为每2秒1次，采样时间为256秒($n=128$)。\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 1))  \ntsplot(fmri1[, 2:5], col = 1:4, ylab = \"BOLD\", main = \"大脑皮层\", spaghetti = TRUE)\ntsplot(fmri1[, 6:9], col = 1:4, ylab = \"BOLD\", main = \"丘脑和小脑\", spaghetti = TRUE)\n```\n\n::: {.cell-output-display}\n![大脑皮层、丘脑、小脑各部位的fMRI数据](index_files/figure-html/fig-fMRI-1.png){#fig-fMRI width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntsplot(fmri1[, 2:9], col = 1:8, lwd = 2, ncol = 2, ylim = c(-.6,.6))\n```\n\n::: {.cell-output-display}\n![分别展示](index_files/figure-html/fig-fMRI_each-1.png){#fig-fMRI_each width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nx = ts(fmri1[, 4:9], start = 0, freq = 32)         \nnames = c(\"大脑皮层\", \"丘脑\", \"小脑\")\nu = ts(rep(c(rep(.6, 16), rep(-.6, 16)), 4), start = 0, freq = 32)\npar(mfrow = c(3, 1))\nfor (i in 1:3){ \n  j = 2*i - 1\n  tsplot(x[, j:(j+1)], ylab = \"BOLD\", xlab = \"\", main = names[i], col = 5:6, ylim = c(-.6, .6), \n         lwd = 2, xaxt = \"n\", spaghetti = TRUE)\n  axis(seq(0, 256, 64), side = 1, at = 0:4)\n  lines(u, type = \"s\", col = gray(.3)) \n}\nmtext(\"seconds\", side = 1, line = 1.75, cex = .9)\n```\n\n::: {.cell-output-display}\n![包含刺激信息](index_files/figure-html/fig-fMRI_each_2-1.png){#fig-fMRI_each_2 width=672}\n:::\n:::\n\n\n## 地震和爆炸\n\n`EQ5`：某地区地震的纵波和横波(两阶段)\n`EXP6`：某地区爆炸的纵波和横波(两阶段)\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = 2:1)\ntsplot(EQ5,  col = 4, main = \"地震\")\ntsplot(EXP6, col = 4, main = \"爆炸\")\n```\n\n::: {.cell-output-display}\n![地震和爆炸两阶段，1秒40个采样点](index_files/figure-html/fig-earthquakes-1.png){#fig-earthquakes width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}